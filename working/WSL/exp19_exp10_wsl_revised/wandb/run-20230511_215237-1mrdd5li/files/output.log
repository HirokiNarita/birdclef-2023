
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-3.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 4 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos





















































































100%|██████████| 154/154 [02:58<00:00,  1.16s/it]




































































 99%|█████████▉| 3359/3381 [02:16<00:00, 28.07it/s]
100%|██████████| 3381/3381 [02:17<00:00, 24.62it/s]


















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]





































































100%|█████████▉| 3366/3381 [02:17<00:00, 30.30it/s]
100%|██████████| 3381/3381 [02:18<00:00, 24.42it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]




































































100%|█████████▉| 3371/3381 [02:16<00:00, 28.69it/s]
100%|██████████| 3381/3381 [02:16<00:00, 24.68it/s]


















































































100%|██████████| 154/154 [02:50<00:00,  1.11s/it]





































































100%|█████████▉| 3378/3381 [02:18<00:00, 32.62it/s]
100%|██████████| 3381/3381 [02:18<00:00, 24.32it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]





































































100%|█████████▉| 3380/3381 [02:19<00:00, 32.24it/s]
100%|██████████| 3381/3381 [02:19<00:00, 24.29it/s]



















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|██████████| 3381/3381 [02:20<00:00, 24.10it/s]
Epoch: 6 | Train Loss: 3.5583705561501637 | Val Loss: 5.2172757207695035 | Val Padded_cmAP : 0.9059201275428936




















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]





































































100%|██████████| 3381/3381 [02:19<00:00, 24.19it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|██████████| 3381/3381 [02:20<00:00, 24.14it/s]
Epoch: 8 | Train Loss: 3.527279341375673 | Val Loss: 5.232514690697035 | Val Padded_cmAP : 0.9103160784799158


















































































100%|██████████| 154/154 [02:51<00:00,  1.12s/it]




































































100%|█████████▉| 3379/3381 [02:16<00:00, 32.86it/s]
100%|██████████| 3381/3381 [02:16<00:00, 24.71it/s]


















































































100%|██████████| 154/154 [02:49<00:00,  1.10s/it]




































































100%|██████████| 3381/3381 [02:17<00:00, 24.60it/s]
Epoch: 10 | Train Loss: 3.507518066988363 | Val Loss: 5.213527443069778 | Val Padded_cmAP : 0.9192712081112565


















































































100%|██████████| 154/154 [02:51<00:00,  1.11s/it]




































































100%|██████████| 3381/3381 [02:18<00:00, 24.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]





































































100%|██████████| 3381/3381 [02:20<00:00, 24.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:53<00:00,  1.12s/it]




































































100%|██████████| 3381/3381 [02:18<00:00, 24.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]




































































100%|██████████| 3381/3381 [02:18<00:00, 24.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]





































































100%|██████████| 3381/3381 [02:18<00:00, 24.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]





































































100%|██████████| 3381/3381 [02:19<00:00, 24.32it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:53<00:00,  1.12s/it]






































































100%|██████████| 3381/3381 [02:20<00:00, 24.14it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]





































































100%|█████████▉| 3380/3381 [02:18<00:00, 32.36it/s]
100%|██████████| 3381/3381 [02:19<00:00, 24.32it/s]


















































































100%|██████████| 154/154 [02:50<00:00,  1.11s/it]




































































 99%|█████████▉| 3364/3381 [02:17<00:00, 30.23it/s]
100%|██████████| 3381/3381 [02:18<00:00, 24.49it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]





































































100%|█████████▉| 3369/3381 [02:18<00:00, 27.69it/s]
100%|██████████| 3381/3381 [02:19<00:00, 24.25it/s]





















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]





































































100%|█████████▉| 3378/3381 [02:20<00:00, 31.02it/s]
100%|██████████| 3381/3381 [02:20<00:00, 24.07it/s]




















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]






































































100%|█████████▉| 3378/3381 [02:20<00:00, 31.33it/s]
100%|██████████| 3381/3381 [02:20<00:00, 24.07it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]





































































100%|██████████| 3381/3381 [02:19<00:00, 24.17it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]





































































100%|█████████▉| 3378/3381 [02:19<00:00, 32.65it/s]
100%|██████████| 3381/3381 [02:19<00:00, 24.16it/s]


















































































100%|██████████| 154/154 [02:50<00:00,  1.11s/it]





































































100%|██████████| 3381/3381 [02:19<00:00, 24.31it/s]
Epoch: 25 | Train Loss: 3.409489784921919 | Val Loss: 5.20481279410402 | Val Padded_cmAP : 0.9335036853321383





















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]




































































100%|██████████| 3381/3381 [02:18<00:00, 24.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:51<00:00,  1.11s/it]




































































100%|██████████| 3381/3381 [02:18<00:00, 24.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:50<00:00,  1.10s/it]




































































100%|█████████▉| 3368/3381 [02:16<00:00, 28.64it/s]
100%|██████████| 3381/3381 [02:17<00:00, 24.65it/s]


















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]




































































100%|██████████| 3381/3381 [02:18<00:00, 24.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]





































































100%|██████████| 3381/3381 [02:18<00:00, 24.47it/s]
Epoch: 30 | Train Loss: 3.3851717555677734 | Val Loss: 5.210618838936717 | Val Padded_cmAP : 0.9339382629291771
# Loading best model
# Infering OOF



































































100%|██████████| 3381/3381 [02:17<00:00, 24.67it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
>>> FOLD 4 Padded_cmAP = 0.935
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value















wandb : 100%|██████████| 714/714 [00:31<00:00, 22.69it/s]