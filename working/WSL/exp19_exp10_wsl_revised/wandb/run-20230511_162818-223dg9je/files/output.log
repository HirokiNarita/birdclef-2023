load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-1.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 2 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,629 | Num Valid: 3,382























































































100%|██████████| 154/154 [03:01<00:00,  1.18s/it]







































































100%|██████████| 3382/3382 [02:26<00:00, 23.03it/s]
Epoch: 1 | Train Loss: 4.220270426242383 | Val Loss: 5.237649473757662 | Val Padded_cmAP : 0.8414857586532839




















































































100%|██████████| 154/154 [02:56<00:00,  1.14s/it]








































































100%|█████████▉| 3379/3382 [02:27<00:00, 29.05it/s]
100%|██████████| 3382/3382 [02:27<00:00, 22.86it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]









































































100%|██████████| 3382/3382 [02:28<00:00, 22.85it/s]
Epoch: 3 | Train Loss: 3.6912060201942145 | Val Loss: 5.249724489355285 | Val Padded_cmAP : 0.8872928945081213




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]







































































100%|██████████| 3382/3382 [02:27<00:00, 22.97it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:54<00:00,  1.14s/it]







































































100%|█████████▉| 3374/3382 [02:27<00:00, 28.88it/s]
100%|██████████| 3382/3382 [02:27<00:00, 22.86it/s]




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]







































































100%|██████████| 3382/3382 [02:27<00:00, 22.88it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






















































































100%|██████████| 154/154 [02:57<00:00,  1.15s/it]








































































100%|█████████▉| 3379/3382 [02:27<00:00, 29.50it/s]
100%|██████████| 3382/3382 [02:28<00:00, 22.82it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]







































































100%|██████████| 3382/3382 [02:26<00:00, 23.03it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]








































































100%|██████████| 3382/3382 [02:27<00:00, 23.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]








































































100%|██████████| 3382/3382 [02:25<00:00, 23.18it/s]
Epoch: 10 | Train Loss: 3.5262070491716457 | Val Loss: 5.22985069953359 | Val Padded_cmAP : 0.915229916855395




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]







































































100%|██████████| 3382/3382 [02:24<00:00, 23.43it/s]
Epoch: 11 | Train Loss: 3.5109874056531236 | Val Loss: 5.22230611772385 | Val Padded_cmAP : 0.921212447925004




















































































100%|██████████| 154/154 [02:53<00:00,  1.12s/it]








































































100%|██████████| 3382/3382 [02:25<00:00, 23.24it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:51<00:00,  1.11s/it]






































































100%|██████████| 3382/3382 [02:24<00:00, 23.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:48<00:00,  1.10s/it]





































































100%|██████████| 3382/3382 [02:24<00:00, 23.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:48<00:00,  1.10s/it]





































































100%|██████████| 3382/3382 [02:24<00:00, 23.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:49<00:00,  1.10s/it]






































































100%|██████████| 3382/3382 [02:24<00:00, 23.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:49<00:00,  1.10s/it]





































































 99%|█████████▉| 3365/3382 [02:23<00:00, 30.96it/s]
100%|██████████| 3382/3382 [02:24<00:00, 23.42it/s]


















































































100%|██████████| 154/154 [02:48<00:00,  1.10s/it]




































































100%|██████████| 3382/3382 [02:24<00:00, 31.79it/s]
100%|██████████| 3382/3382 [02:24<00:00, 23.43it/s]


















































































100%|██████████| 154/154 [02:50<00:00,  1.11s/it]






































































100%|██████████| 3382/3382 [02:23<00:00, 23.52it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

















































































100%|██████████| 154/154 [02:50<00:00,  1.10s/it]







































































100%|█████████▉| 3380/3382 [02:24<00:00, 28.16it/s]
100%|██████████| 3382/3382 [02:24<00:00, 23.35it/s]



















































































100%|██████████| 154/154 [02:51<00:00,  1.11s/it]





































































100%|██████████| 3382/3382 [02:24<00:00, 23.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:51<00:00,  1.12s/it]






































































 99%|█████████▉| 3357/3382 [02:22<00:00, 28.81it/s]
100%|██████████| 3382/3382 [02:23<00:00, 23.50it/s]


















































































100%|██████████| 154/154 [02:49<00:00,  1.10s/it]






































































 99%|█████████▉| 3362/3382 [02:23<00:00, 29.39it/s]
100%|██████████| 3382/3382 [02:24<00:00, 23.42it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]






































































 99%|█████████▉| 3362/3382 [02:24<00:00, 29.00it/s]
100%|██████████| 3382/3382 [02:25<00:00, 23.28it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]







































































100%|██████████| 3382/3382 [02:25<00:00, 23.24it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|█████████▉| 3378/3382 [02:23<00:00, 31.34it/s]
100%|██████████| 3382/3382 [02:23<00:00, 23.59it/s]



















































































100%|██████████| 154/154 [02:51<00:00,  1.11s/it]






































































100%|██████████| 3382/3382 [02:23<00:00, 23.49it/s]
Epoch: 27 | Train Loss: 3.419041709466414 | Val Loss: 5.22226596780954 | Val Padded_cmAP : 0.9315204966348654


















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]






































































 99%|█████████▉| 3362/3382 [02:24<00:00, 29.93it/s]
100%|██████████| 3382/3382 [02:24<00:00, 23.35it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]






































































100%|██████████| 3382/3382 [02:24<00:00, 23.43it/s]
Epoch: 29 | Train Loss: 3.3995221357840997 | Val Loss: 5.216571898660598 | Val Padded_cmAP : 0.933860701338082




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]






































































100%|██████████| 3382/3382 [02:23<00:00, 23.49it/s]
  0%|          | 12/3382 [00:00<02:33, 21.99it/s]
Epoch: 30 | Train Loss: 3.4171806960910946 | Val Loss: 5.219040592628989 | Val Padded_cmAP : 0.9337271284935682
# Loading best model







































































100%|█████████▉| 3379/3382 [02:24<00:00, 30.73it/s]
>>> FOLD 2 Padded_cmAP = 0.934
100%|██████████| 3382/3382 [02:24<00:00, 23.37it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value

















wandb : 100%|██████████| 705/705 [00:36<00:00, 19.27it/s]