
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-0.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'fc1.weight', 'fc1.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=[])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
































































































100%|██████████| 154/154 [04:19<00:00,  1.68s/it]






100%|██████████| 27/27 [00:14<00:00,  1.86it/s]
Epoch: 1 | Train Loss: 0.3127864184366031 | Val Loss: 0.008954267810892176 | Val Padded_cmAP : 0.4793837977619723






















































































100%|██████████| 154/154 [04:00<00:00,  1.56s/it]





 89%|████████▉ | 24/27 [00:13<00:01,  2.34it/s]
100%|██████████| 27/27 [00:14<00:00,  1.87it/s]






























































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






100%|██████████| 27/27 [00:14<00:00,  1.88it/s]
Epoch: 3 | Train Loss: 0.0068606807360449785 | Val Loss: 0.00742673825610567 | Val Padded_cmAP : 0.4971788353541546


























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






 89%|████████▉ | 24/27 [00:13<00:01,  2.36it/s]
100%|██████████| 27/27 [00:14<00:00,  1.86it/s]





























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]







100%|██████████| 27/27 [00:14<00:00,  1.86it/s]
Epoch: 5 | Train Loss: 0.004506442673177785 | Val Loss: 0.004590693572363643 | Val Padded_cmAP : 0.5898667143074713































































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]





100%|██████████| 27/27 [00:14<00:00,  1.88it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






 89%|████████▉ | 24/27 [00:13<00:01,  2.41it/s]
100%|██████████| 27/27 [00:14<00:00,  1.85it/s]




























































































100%|██████████| 154/154 [03:14<00:00,  1.26s/it]






 96%|█████████▋| 26/27 [00:13<00:00,  2.46it/s]
100%|██████████| 27/27 [00:14<00:00,  1.90it/s]






























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






 93%|█████████▎| 25/27 [00:13<00:00,  2.46it/s]
100%|██████████| 27/27 [00:14<00:00,  1.86it/s]



























































































100%|██████████| 154/154 [03:13<00:00,  1.26s/it]






100%|██████████| 27/27 [00:14<00:00,  1.89it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:11<00:00,  1.24s/it]






100%|██████████| 27/27 [00:14<00:00,  1.86it/s]
Epoch: 11 | Train Loss: 0.001997997418844274 | Val Loss: 0.001832326846111014 | Val Padded_cmAP : 0.8694480832822347





























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]






100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
Epoch: 12 | Train Loss: 0.0018267490917683712 | Val Loss: 0.0017167306052417392 | Val Padded_cmAP : 0.8762131640575878




























































































100%|██████████| 154/154 [03:16<00:00,  1.27s/it]






100%|██████████| 27/27 [00:14<00:00,  1.86it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:14<00:00,  1.26s/it]






100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






 96%|█████████▋| 26/27 [00:14<00:00,  2.51it/s]
100%|██████████| 27/27 [00:14<00:00,  1.86it/s]



























































































100%|██████████| 154/154 [03:13<00:00,  1.26s/it]






100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
Epoch: 16 | Train Loss: 0.0013962645875894792 | Val Loss: 0.0016413475041864095 | Val Padded_cmAP : 0.8871795852294602




























































































100%|██████████| 154/154 [03:16<00:00,  1.27s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]






 93%|█████████▎| 25/27 [00:13<00:00,  2.43it/s]
100%|██████████| 27/27 [00:14<00:00,  1.84it/s]



























































































100%|██████████| 154/154 [03:13<00:00,  1.26s/it]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
Epoch: 19 | Train Loss: 0.0012329314958588401 | Val Loss: 0.0017102793035856277 | Val Padded_cmAP : 0.8890174591190514































































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:27<00:00,  1.35s/it]






100%|██████████| 27/27 [00:14<00:00,  2.98it/s]
100%|██████████| 27/27 [00:14<00:00,  1.84it/s]






























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]





100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






100%|██████████| 27/27 [00:14<00:00,  1.86it/s]
Epoch: 23 | Train Loss: 0.001069086292371541 | Val Loss: 0.0017561679986236548 | Val Padded_cmAP : 0.8908066686250344






























































































100%|██████████| 154/154 [03:16<00:00,  1.27s/it]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:14<00:00,  2.97it/s]
100%|██████████| 27/27 [00:14<00:00,  1.83it/s]

























































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
Epoch: 28 | Train Loss: 0.0009764155936911219 | Val Loss: 0.0018360234766819136 | Val Padded_cmAP : 0.8867644810889211































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]





100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]





100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]





100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:22<00:00,  1.31s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]






 96%|█████████▋| 26/27 [00:14<00:00,  2.48it/s]
100%|██████████| 27/27 [00:14<00:00,  1.86it/s]































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:15<00:00,  1.76it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]





100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:14<00:00,  1.84it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:14<00:00,  1.84it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]





100%|██████████| 27/27 [00:14<00:00,  1.80it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]






 96%|█████████▋| 26/27 [00:14<00:00,  2.46it/s]
100%|██████████| 27/27 [00:14<00:00,  1.80it/s]






























































































100%|██████████| 154/154 [03:24<00:00,  1.33s/it]






 93%|█████████▎| 25/27 [00:14<00:00,  2.44it/s]
100%|██████████| 27/27 [00:15<00:00,  1.77it/s]

































































































100%|██████████| 154/154 [03:23<00:00,  1.32s/it]






 96%|█████████▋| 26/27 [00:14<00:00,  2.46it/s]
100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
































































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
Epoch: 47 | Train Loss: 0.0008013798313233518 | Val Loss: 0.0020286459583547657 | Val Padded_cmAP : 0.8898063274521538





























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]





100%|██████████| 27/27 [00:14<00:00,  1.80it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]





100%|██████████| 27/27 [00:14<00:00,  1.84it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:22<00:00,  1.31s/it]






100%|██████████| 27/27 [00:14<00:00,  1.84it/s]
Epoch: 50 | Train Loss: 0.0007836261976588905 | Val Loss: 0.0020383314824559623 | Val Padded_cmAP : 0.8904600494454499
# Loading best model
# Infering OOF
 11%|█         | 3/27 [00:03<00:20,  1.18it/s]
 30%|██▉       | 8/27 [00:05<00:08,  2.24it/s]
 48%|████▊     | 13/27 [00:07<00:05,  2.37it/s]
 67%|██████▋   | 18/27 [00:09<00:03,  2.51it/s]
 85%|████████▌ | 23/27 [00:11<00:01,  2.55it/s]
Try using .loc[row_indexer,col_indexer] = value instead DataFrame.7: SettingWithCopyWarning: me is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
Try using .loc[row_indexer,col_indexer] = value instead DataFrame.7: SettingWithCopyWarning: me is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
>>> FOLD 1 Padded_cmAP = 0.891
# WandB



















wandb : 100%|██████████| 686/686 [00:38<00:00, 17.94it/s]