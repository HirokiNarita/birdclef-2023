load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-0.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381















































































































100%|██████████| 154/154 [04:21<00:00,  1.70s/it]










































































100%|█████████▉| 3378/3381 [02:28<00:00, 26.09it/s]
100%|██████████| 3381/3381 [02:28<00:00, 22.73it/s]





































































































100%|██████████| 154/154 [03:56<00:00,  1.54s/it]










































































100%|██████████| 3381/3381 [02:28<00:00, 22.81it/s]
Epoch: 2 | Train Loss: 3.7908551197547418 | Val Loss: 5.234290155987879 | Val Padded_cmAP : 0.8816197134414319





















































































100%|██████████| 154/154 [02:57<00:00,  1.15s/it]






































































100%|██████████| 3381/3381 [02:21<00:00, 23.85it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:59<00:00,  1.17s/it]






































































100%|██████████| 3381/3381 [02:22<00:00, 23.81it/s]
Epoch: 4 | Train Loss: 3.6235032453165426 | Val Loss: 5.211528912340879 | Val Padded_cmAP : 0.9005208072989318





















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]






































































100%|██████████| 3381/3381 [02:23<00:00, 23.55it/s]
Epoch: 5 | Train Loss: 3.594309303667638 | Val Loss: 5.212787217340749 | Val Padded_cmAP : 0.9090548342126121






















































































100%|██████████| 154/154 [02:59<00:00,  1.17s/it]







































































100%|██████████| 3381/3381 [02:23<00:00, 23.60it/s]
Epoch: 6 | Train Loss: 3.574072260361213 | Val Loss: 5.217817826512226 | Val Padded_cmAP : 0.9128057739946981




















































































100%|██████████| 154/154 [02:59<00:00,  1.16s/it]






































































100%|██████████| 3381/3381 [02:23<00:00, 23.62it/s]
Epoch: 7 | Train Loss: 3.5556537268997785 | Val Loss: 5.220288660144778 | Val Padded_cmAP : 0.9152989309971964




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]




































































100%|██████████| 3381/3381 [02:20<00:00, 24.13it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]






































































100%|██████████| 3381/3381 [02:21<00:00, 23.89it/s]
Epoch: 9 | Train Loss: 3.527323520028746 | Val Loss: 5.23195560864886 | Val Padded_cmAP : 0.9216962941297022



















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]





































































100%|██████████| 3381/3381 [02:20<00:00, 24.12it/s]
Epoch: 10 | Train Loss: 3.529550617391413 | Val Loss: 5.2262032227345525 | Val Padded_cmAP : 0.9220801856240062



















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]





































































100%|██████████| 3381/3381 [02:21<00:00, 23.89it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:53<00:00,  1.12s/it]





































































100%|██████████| 3381/3381 [02:20<00:00, 24.13it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:53<00:00,  1.12s/it]




































































100%|██████████| 3381/3381 [02:21<00:00, 23.88it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]




































































100%|██████████| 3381/3381 [02:19<00:00, 24.20it/s]
Epoch: 14 | Train Loss: 3.4875326698476616 | Val Loss: 5.206611427531656 | Val Padded_cmAP : 0.9294795200080885





















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]





































































 99%|█████████▉| 3361/3381 [02:20<00:00, 29.94it/s]
100%|██████████| 3381/3381 [02:21<00:00, 23.83it/s]





















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]




































































100%|█████████▉| 3372/3381 [02:19<00:00, 21.80it/s]
100%|██████████| 3381/3381 [02:19<00:00, 24.19it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.14s/it]





































































100%|█████████▉| 3372/3381 [02:18<00:00, 22.24it/s]
100%|██████████| 3381/3381 [02:19<00:00, 24.27it/s]


















































































100%|██████████| 154/154 [02:51<00:00,  1.12s/it]




































































100%|██████████| 3381/3381 [02:19<00:00, 24.26it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]






































































100%|█████████▉| 3373/3381 [02:21<00:00, 22.75it/s]
100%|██████████| 3381/3381 [02:21<00:00, 23.88it/s]




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]







































































100%|██████████| 3381/3381 [02:22<00:00, 23.77it/s]
Epoch: 20 | Train Loss: 3.4425004767133043 | Val Loss: 5.210066132205578 | Val Padded_cmAP : 0.9348605656459222






















































































100%|██████████| 154/154 [03:00<00:00,  1.17s/it]






































































100%|██████████| 3381/3381 [02:22<00:00, 23.75it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:56<00:00,  1.14s/it]







































































100%|██████████| 3381/3381 [02:22<00:00, 29.20it/s]
100%|██████████| 3381/3381 [02:22<00:00, 23.71it/s]





















































































100%|██████████| 154/154 [02:57<00:00,  1.15s/it]







































































100%|██████████| 3381/3381 [02:22<00:00, 23.81it/s]
Epoch: 23 | Train Loss: 3.4296913146972656 | Val Loss: 5.21299136160958 | Val Padded_cmAP : 0.9350930674395543



















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|██████████| 3381/3381 [02:21<00:00, 23.86it/s]
Epoch: 24 | Train Loss: 3.41516815222703 | Val Loss: 5.219365330075273 | Val Padded_cmAP : 0.9362441012902203



















































































100%|██████████| 154/154 [02:58<00:00,  1.16s/it]






































































100%|██████████| 3381/3381 [02:22<00:00, 23.75it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|██████████| 3381/3381 [02:22<00:00, 23.78it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]





































































 99%|█████████▉| 3362/3381 [02:21<00:00, 25.35it/s]
100%|██████████| 3381/3381 [02:21<00:00, 23.83it/s]



















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]






































































100%|█████████▉| 3373/3381 [02:23<00:00, 20.94it/s]
100%|██████████| 3381/3381 [02:23<00:00, 23.57it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]







































































100%|██████████| 3381/3381 [02:22<00:00, 23.75it/s]
Epoch: 29 | Train Loss: 3.406422966486448 | Val Loss: 5.2137834579413616 | Val Padded_cmAP : 0.9370575470956594



















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]







































































100%|██████████| 3381/3381 [02:23<00:00, 23.59it/s]
Epoch: 30 | Train Loss: 3.4057627204176666 | Val Loss: 5.206250251520671 | Val Padded_cmAP : 0.9385737833987244
# Loading best model
# Infering OOF






































































100%|██████████| 3381/3381 [02:22<00:00, 23.78it/s]
>>> FOLD 1 Padded_cmAP = 0.939
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value


















wandb : 100%|██████████| 686/686 [00:37<00:00, 18.30it/s]