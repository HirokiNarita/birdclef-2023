
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-2.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'fc1.weight', 'fc1.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=[])
#########################
#### Training
































































































100%|██████████| 154/154 [03:30<00:00,  1.37s/it]






100%|██████████| 27/27 [00:13<00:00,  1.94it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
#### Num Train: 19,629 | Num Valid: 3,381
































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.48it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]





























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.96it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]



























































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 4 | Train Loss: 0.005489721047607335 | Val Loss: 0.0057880796785293905 | Val Padded_cmAP : 0.536935513512193




























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































































100%|██████████| 154/154 [03:24<00:00,  1.33s/it]





100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 7 | Train Loss: 0.0033200198947754386 | Val Loss: 0.0031301677615071335 | Val Padded_cmAP : 0.7571106226570906






























































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 8 | Train Loss: 0.0028876045978833715 | Val Loss: 0.002625292859091941 | Val Padded_cmAP : 0.8112821685204094































































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 9 | Train Loss: 0.0025084130768361803 | Val Loss: 0.0022577912227630063 | Val Padded_cmAP : 0.8405157228823947






























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






 96%|█████████▋| 26/27 [00:13<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]






























































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 12 | Train Loss: 0.001827473892806122 | Val Loss: 0.0018364211039928098 | Val Padded_cmAP : 0.8724824418155221





























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]































































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
Epoch: 15 | Train Loss: 0.0014787023862848033 | Val Loss: 0.001796988498729964 | Val Padded_cmAP : 0.8804265974212532





























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 16 | Train Loss: 0.001388986052963399 | Val Loss: 0.0017991962290748401 | Val Padded_cmAP : 0.8830798557006504





























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 17 | Train Loss: 0.001319569317085741 | Val Loss: 0.0018069429098869915 | Val Padded_cmAP : 0.8837900303106192































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






 96%|█████████▋| 26/27 [00:13<00:00,  2.45it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]

































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]





100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



























































































100%|██████████| 154/154 [03:22<00:00,  1.31s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.37it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]







100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 22 | Train Loss: 0.0011045027935466208 | Val Loss: 0.0019102091685420386 | Val Padded_cmAP : 0.8858520804082562
































































































100%|██████████| 154/154 [03:25<00:00,  1.33s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]





























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]





100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






 89%|████████▉ | 24/27 [00:12<00:01,  2.39it/s]
100%|██████████| 27/27 [00:13<00:00,  1.94it/s]





























































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
































































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 30 | Train Loss: 0.0009501095575449818 | Val Loss: 0.002141589635155267 | Val Padded_cmAP : 0.8850748469338683





























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]





 81%|████████▏ | 22/27 [00:11<00:02,  2.22it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]































































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.35it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]






























































































100%|██████████| 154/154 [03:14<00:00,  1.27s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.41it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]






























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.43it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]



























































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.40it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]






























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]





























































































100%|██████████| 154/154 [03:14<00:00,  1.27s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.40it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]




























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]





 85%|████████▌ | 23/27 [00:12<00:01,  2.30it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]































































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 40 | Train Loss: 0.0008343314429194751 | Val Loss: 0.002345399402892562 | Val Padded_cmAP : 0.8831905318816369































































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






 96%|█████████▋| 26/27 [00:13<00:00,  2.49it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]






























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]





100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 44 | Train Loss: 0.00079823441821598 | Val Loss: 0.0023080566660845995 | Val Padded_cmAP : 0.8849916557062372































































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]





100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]






100%|██████████| 27/27 [00:13<00:00,  2.95it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]






























































































100%|██████████| 154/154 [03:14<00:00,  1.26s/it]






100%|██████████| 27/27 [00:13<00:00,  3.02it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]

































































































100%|██████████| 154/154 [03:22<00:00,  1.31s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.45it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]





 81%|████████▏ | 22/27 [00:11<00:02,  2.10it/s]
Epoch: 50 | Train Loss: 0.0007806007165231972 | Val Loss: 0.0023378218951014182 | Val Padded_cmAP : 0.8852368486699308

100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
# Infering OOF
 30%|██▉       | 8/27 [00:04<00:08,  2.33it/s]
 48%|████▊     | 13/27 [00:06<00:05,  2.46it/s]
 59%|█████▉    | 16/27 [00:07<00:04,  2.52it/s]
 78%|███████▊  | 21/27 [00:09<00:02,  2.51it/s]
100%|██████████| 27/27 [00:11<00:00,  2.29it/s]
100%|██████████| 27/27 [00:11<00:00,  2.29it/s]
>>> FOLD 3 Padded_cmAP = 0.886
Try using .loc[row_indexer,col_indexer] = value instead DataFrame.7: SettingWithCopyWarning: me is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
Try using .loc[row_indexer,col_indexer] = value instead DataFrame.7: SettingWithCopyWarning: me is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   7%|▋         | 53/730 [00:03<00:49, 13.63it/s]
wandb :  13%|█▎        | 98/730 [00:05<00:24, 25.62it/s]
wandb :  18%|█▊        | 132/730 [00:07<00:28, 20.80it/s]
wandb :  24%|██▍       | 177/730 [00:09<00:27, 19.94it/s]
wandb :  27%|██▋       | 198/730 [00:11<00:36, 14.63it/s]
wandb :  31%|███       | 226/730 [00:13<00:22, 22.08it/s]
wandb :  37%|███▋      | 267/730 [00:15<00:17, 26.14it/s]
wandb :  42%|████▏     | 308/730 [00:17<00:20, 20.79it/s]
wandb :  48%|████▊     | 347/730 [00:19<00:24, 15.45it/s]
wandb :  52%|█████▏    | 377/730 [00:21<00:18, 18.94it/s]
wandb :  54%|█████▍    | 396/730 [00:22<00:17, 19.31it/s]
wandb :  59%|█████▉    | 429/730 [00:25<00:16, 18.44it/s]
wandb :  64%|██████▍   | 466/730 [00:27<00:12, 21.48it/s]
wandb :  69%|██████▉   | 507/730 [00:29<00:10, 22.03it/s]
wandb :  75%|███████▌  | 548/730 [00:31<00:08, 20.25it/s]
wandb :  83%|████████▎ | 605/730 [00:33<00:04, 27.57it/s]
wandb :  85%|████████▍ | 619/730 [00:35<00:13,  7.94it/s]
wandb :  90%|█████████ | 657/730 [00:37<00:03, 22.91it/s]
wandb :  95%|█████████▍| 691/730 [00:39<00:03, 11.85it/s]
wandb :  98%|█████████▊| 714/730 [00:41<00:00, 17.58it/s]
wandb : 100%|██████████| 730/730 [00:42<00:00, 17.35it/s]
wandb : 100%|██████████| 730/730 [00:42<00:00, 17.35it/s]