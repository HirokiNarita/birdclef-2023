
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-3.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'fc1.weight', 'fc1.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=[])
#########################
#### Training
#### Fold: 4 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos


































































































100%|██████████| 154/154 [03:32<00:00,  1.38s/it]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 1 | Train Loss: 0.30190656872393634 | Val Loss: 0.008439666712311682 | Val Padded_cmAP : 0.4800485447157493






























































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 2 | Train Loss: 0.008918525164269588 | Val Loss: 0.009398627250144878 | Val Padded_cmAP : 0.48202597212917114

































































































100%|██████████| 154/154 [03:24<00:00,  1.33s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.43it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]





























































































100%|██████████| 154/154 [03:25<00:00,  1.34s/it]






 93%|█████████▎| 25/27 [00:13<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  1.94it/s]






























































































100%|██████████| 154/154 [03:15<00:00,  1.27s/it]







100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 5 | Train Loss: 0.004519601246680726 | Val Loss: 0.004504841321182472 | Val Padded_cmAP : 0.5996627823249421































































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 7 | Train Loss: 0.0032706601672213187 | Val Loss: 0.002957050242306044 | Val Padded_cmAP : 0.7703061799651305

































































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 9 | Train Loss: 0.0024462990816561626 | Val Loss: 0.002155223861336708 | Val Padded_cmAP : 0.8420391424053536





























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 10 | Train Loss: 0.0021756335287112984 | Val Loss: 0.002036840105170591 | Val Padded_cmAP : 0.8568211471484201






























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 13 | Train Loss: 0.001655151105225812 | Val Loss: 0.0017792760670461037 | Val Padded_cmAP : 0.8741282594419643

































































































100%|██████████| 154/154 [03:22<00:00,  1.31s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]































































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 16 | Train Loss: 0.001399219803385098 | Val Loss: 0.0016988578718155622 | Val Padded_cmAP : 0.880584723614676

































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 19 | Train Loss: 0.0012211467622470886 | Val Loss: 0.0017869412291070654 | Val Padded_cmAP : 0.8828698401541639

































































































100%|██████████| 154/154 [03:22<00:00,  1.31s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 20 | Train Loss: 0.001163880299556057 | Val Loss: 0.0018258735610827527 | Val Padded_cmAP : 0.8815400007215979






























































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.46it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
































































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.31it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
























































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]






























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.44it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]





























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]





 85%|████████▌ | 23/27 [00:11<00:01,  2.34it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
































































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.41it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]































































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



























































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.39it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]



























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 29 | Train Loss: 0.000944631639868021 | Val Loss: 0.0020997638003555715 | Val Padded_cmAP : 0.8817123483778704





























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]






 89%|████████▉ | 24/27 [00:12<00:01,  2.40it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]



























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]





100%|██████████| 27/27 [00:13<00:00,  1.95it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]





100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]






 96%|█████████▋| 26/27 [00:13<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]



























































































100%|██████████| 154/154 [03:16<00:00,  1.28s/it]





100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 37 | Train Loss: 0.000876557341604433 | Val Loss: 0.002245227495829264 | Val Padded_cmAP : 0.8791798736063916























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 38 | Train Loss: 0.0008484890220336036 | Val Loss: 0.002195262518297467 | Val Padded_cmAP : 0.8802595658717011






























































































100%|██████████| 154/154 [03:17<00:00,  1.28s/it]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































































100%|██████████| 154/154 [03:24<00:00,  1.33s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.37it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
































































































100%|██████████| 154/154 [03:22<00:00,  1.32s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.40it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]































































































100%|██████████| 154/154 [03:18<00:00,  1.29s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 43 | Train Loss: 0.0008069731997380445 | Val Loss: 0.0022465429199790515 | Val Padded_cmAP : 0.8819136030770204





























































































100%|██████████| 154/154 [03:19<00:00,  1.30s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.37it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]


























































































100%|██████████| 154/154 [03:20<00:00,  1.30s/it]





 89%|████████▉ | 24/27 [00:12<00:01,  2.37it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]























































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






100%|██████████| 27/27 [00:13<00:00,  2.99it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]































































































100%|██████████| 154/154 [03:23<00:00,  1.32s/it]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]































































































100%|██████████| 154/154 [03:21<00:00,  1.31s/it]






 93%|█████████▎| 25/27 [00:12<00:00,  2.41it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]




























































































100%|██████████| 154/154 [03:24<00:00,  1.33s/it]






 96%|█████████▋| 26/27 [00:13<00:00,  2.49it/s]
100%|██████████| 27/27 [00:13<00:00,  2.02it/s]





























































































100%|██████████| 154/154 [03:19<00:00,  1.29s/it]





100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 50 | Train Loss: 0.0007652740671553395 | Val Loss: 0.0022287990216648687 | Val Padded_cmAP : 0.8825599339678168
# Loading best model
  7%|▋         | 2/27 [00:01<00:20,  1.21it/s]
 26%|██▌       | 7/27 [00:03<00:08,  2.28it/s]
 44%|████▍     | 12/27 [00:05<00:06,  2.49it/s]
 63%|██████▎   | 17/27 [00:07<00:04,  2.49it/s]
 81%|████████▏ | 22/27 [00:09<00:01,  2.55it/s]
  self[col] = igetitem(value, i)ckages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)ckages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
>>> FOLD 4 Padded_cmAP = 0.883
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self.obj[key] = value
wandb :   8%|▊         | 57/727 [00:03<00:32, 20.33it/s]
wandb :  14%|█▍        | 103/727 [00:05<00:31, 19.57it/s]
wandb :  21%|██▏       | 155/727 [00:07<00:22, 25.20it/s]
wandb :  25%|██▌       | 184/727 [00:09<00:37, 14.31it/s]
wandb :  29%|██▊       | 209/727 [00:11<00:29, 17.37it/s]
wandb :  33%|███▎      | 242/727 [00:13<00:26, 18.20it/s]
wandb :  38%|███▊      | 277/727 [00:15<00:22, 20.27it/s]
wandb :  43%|████▎     | 316/727 [00:17<00:15, 26.75it/s]
wandb :  48%|████▊     | 351/727 [00:19<00:19, 19.25it/s]
wandb :  55%|█████▍    | 397/727 [00:21<00:12, 26.67it/s]
wandb :  60%|██████    | 438/727 [00:23<00:14, 20.49it/s]
wandb :  67%|██████▋   | 485/727 [00:25<00:10, 23.33it/s]
wandb :  72%|███████▏  | 522/727 [00:27<00:09, 21.71it/s]
wandb :  78%|███████▊  | 564/727 [00:29<00:07, 21.99it/s]
wandb :  83%|████████▎ | 606/727 [00:31<00:07, 17.06it/s]
wandb :  88%|████████▊ | 637/727 [00:33<00:07, 12.47it/s]
wandb :  92%|█████████▏| 672/727 [00:35<00:02, 21.68it/s]
wandb :  96%|█████████▌| 699/727 [00:37<00:01, 19.75it/s]
wandb : 100%|██████████| 727/727 [00:39<00:00, 18.64it/s]
wandb : 100%|██████████| 727/727 [00:39<00:00, 18.64it/s]