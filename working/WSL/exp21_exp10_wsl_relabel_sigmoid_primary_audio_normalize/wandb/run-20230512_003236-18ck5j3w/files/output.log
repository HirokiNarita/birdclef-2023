load pre-trained model :  /kaggle/working/WSL/exp10_softmax_model/fold-4.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 5 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,624 | Num Valid: 3,380



















































































100%|██████████| 154/154 [03:01<00:00,  1.18s/it]





































































100%|██████████| 3380/3380 [02:20<00:00, 24.03it/s]
Epoch: 1 | Train Loss: 4.231164828523413 | Val Loss: 5.221372708625342 | Val Padded_cmAP : 0.8429193903881785

















































































100%|██████████| 154/154 [02:49<00:00,  1.10s/it]





































































100%|██████████| 3380/3380 [02:22<00:00, 23.80it/s]
Epoch: 2 | Train Loss: 3.7954347040746117 | Val Loss: 5.232371212603778 | Val Padded_cmAP : 0.8767707895124656



















































































100%|██████████| 154/154 [02:50<00:00,  1.11s/it]






































































100%|██████████| 3380/3380 [02:22<00:00, 23.76it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]







































































100%|██████████| 3380/3380 [02:24<00:00, 23.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]







































































100%|██████████| 3380/3380 [02:24<00:00, 23.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]







































































100%|██████████| 3380/3380 [02:23<00:00, 23.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:54<00:00,  1.14s/it]






































































100%|██████████| 3380/3380 [02:23<00:00, 23.52it/s]
Epoch: 7 | Train Loss: 3.564151867643579 | Val Loss: 5.207317611310609 | Val Padded_cmAP : 0.9122694434009746



















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]








































































100%|██████████| 3380/3380 [02:24<00:00, 23.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]







































































100%|██████████| 3380/3380 [02:23<00:00, 23.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]






































































 99%|█████████▉| 3351/3380 [02:22<00:00, 29.21it/s]
100%|██████████| 3380/3380 [02:23<00:00, 23.50it/s]





















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]






































































100%|██████████| 3380/3380 [02:23<00:00, 23.57it/s]
Epoch: 11 | Train Loss: 3.509301982916795 | Val Loss: 5.2287869862550815 | Val Padded_cmAP : 0.9227499657187347






















































































100%|██████████| 154/154 [02:57<00:00,  1.15s/it]






































































100%|██████████| 3380/3380 [02:23<00:00, 23.56it/s]
Epoch: 12 | Train Loss: 3.49355605670384 | Val Loss: 5.220795362235527 | Val Padded_cmAP : 0.9243133629912765





















































































100%|██████████| 154/154 [02:54<00:00,  1.14s/it]







































































100%|█████████▉| 3372/3380 [02:23<00:00, 26.44it/s]
100%|██████████| 3380/3380 [02:23<00:00, 23.53it/s]





















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]






































































100%|██████████| 3380/3380 [02:23<00:00, 23.54it/s]
Epoch: 14 | Train Loss: 3.4855563408368595 | Val Loss: 5.223231274136425 | Val Padded_cmAP : 0.9279934151979252



















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]






































































100%|██████████| 3380/3380 [02:22<00:00, 23.65it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:56<00:00,  1.14s/it]






































































100%|██████████| 3380/3380 [02:23<00:00, 23.59it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]








































































100%|██████████| 3380/3380 [02:25<00:00, 23.25it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]







































































100%|██████████| 3380/3380 [02:23<00:00, 23.50it/s]
Epoch: 18 | Train Loss: 3.466696053356319 | Val Loss: 5.216419824199564 | Val Padded_cmAP : 0.9314275932075415




















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]








































































100%|██████████| 3380/3380 [02:25<00:00, 23.21it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|█████████▉| 3375/3380 [02:22<00:00, 29.13it/s]
100%|██████████| 3380/3380 [02:22<00:00, 23.65it/s]





















































































100%|██████████| 154/154 [02:57<00:00,  1.15s/it]








































































 99%|█████████▉| 3357/3380 [02:24<00:00, 28.62it/s]
100%|██████████| 3380/3380 [02:25<00:00, 23.24it/s]





















































































100%|██████████| 154/154 [02:56<00:00,  1.15s/it]







































































100%|█████████▉| 3379/3380 [02:24<00:00, 28.76it/s]
100%|██████████| 3380/3380 [02:24<00:00, 23.36it/s]




















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]









































































100%|██████████| 3380/3380 [02:25<00:00, 23.19it/s]
Epoch: 23 | Train Loss: 3.4312532040979957 | Val Loss: 5.215451448626772 | Val Padded_cmAP : 0.9339556361607173





















































































100%|██████████| 154/154 [02:56<00:00,  1.14s/it]







































































100%|██████████| 3380/3380 [02:25<00:00, 23.27it/s]
Epoch: 24 | Train Loss: 3.422038349238309 | Val Loss: 5.218939870349049 | Val Padded_cmAP : 0.9330261645623074




















































































100%|██████████| 154/154 [02:53<00:00,  1.13s/it]





































































100%|██████████| 3380/3380 [02:22<00:00, 23.66it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



















































































100%|██████████| 154/154 [02:52<00:00,  1.12s/it]





































































100%|██████████| 3380/3380 [02:22<00:00, 23.78it/s]
Epoch: 26 | Train Loss: 3.4347123619797943 | Val Loss: 5.20388792054893 | Val Padded_cmAP : 0.9370409125428627





















































































100%|██████████| 154/154 [02:55<00:00,  1.14s/it]






































































100%|██████████| 3380/3380 [02:21<00:00, 23.82it/s]
Epoch: 27 | Train Loss: 3.4272159307033983 | Val Loss: 5.2167194091356714 | Val Padded_cmAP : 0.9355949520370295



















































































100%|██████████| 154/154 [02:51<00:00,  1.12s/it]





































































100%|██████████| 3380/3380 [02:21<00:00, 23.81it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





















































































100%|██████████| 154/154 [02:54<00:00,  1.13s/it]






































































100%|██████████| 3380/3380 [02:22<00:00, 23.68it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


















































































100%|██████████| 154/154 [02:51<00:00,  1.11s/it]







































































100%|██████████| 3380/3380 [02:23<00:00, 23.48it/s]
Epoch: 30 | Train Loss: 3.405503262173046 | Val Loss: 5.211394786270413 | Val Padded_cmAP : 0.9359728513056763
# Loading best model
# Infering OOF







































































100%|██████████| 3380/3380 [02:24<00:00, 23.33it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 0/709 [00:00<?, ?it/s]
>>> FOLD 5 Padded_cmAP = 0.937

















wandb : 100%|██████████| 709/709 [00:33<00:00, 21.02it/s]