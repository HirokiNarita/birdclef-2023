load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381









































































100%|██████████| 154/154 [02:39<00:00,  1.04s/it]










 89%|████████▉ | 24/27 [00:26<00:02,  1.26it/s]
100%|██████████| 27/27 [00:28<00:00,  1.07s/it]









































































100%|██████████| 154/154 [02:32<00:00,  1.01it/s]










 96%|█████████▋| 26/27 [00:28<00:00,  1.38it/s]
100%|██████████| 27/27 [00:28<00:00,  1.06s/it]









































































100%|██████████| 154/154 [02:32<00:00,  1.01it/s]












100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
Epoch: 3 | Train Loss: 0.005746073162110595 | Val Loss: 0.006176717527624633 | Val Padded_cmAP : 0.4607993463936062









































































100%|██████████| 154/154 [02:32<00:00,  1.01it/s]












 96%|█████████▋| 26/27 [00:28<00:00,  1.31it/s]
100%|██████████| 27/27 [00:28<00:00,  1.06s/it]










































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]










 93%|█████████▎| 25/27 [00:27<00:01,  1.11it/s]
100%|██████████| 27/27 [00:28<00:00,  1.06s/it]









































































100%|██████████| 154/154 [02:32<00:00,  1.01it/s]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]












 96%|█████████▋| 26/27 [00:28<00:00,  1.27it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]










































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]












 96%|█████████▋| 26/27 [00:28<00:00,  1.31it/s]
100%|██████████| 27/27 [00:28<00:00,  1.07s/it]










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]










100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
  0%|          | 0/154 [00:00<?, ?it/s]









































































100%|██████████| 154/154 [02:32<00:00,  1.01it/s]











100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
  0%|          | 0/154 [00:00<?, ?it/s]










































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]













100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
Epoch: 11 | Train Loss: 0.0027222198119701505 | Val Loss: 0.0027058619242678913 | Val Padded_cmAP : 0.7761737140308271









































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]











100%|██████████| 27/27 [00:29<00:00,  1.08s/it]
  0%|          | 0/154 [00:00<?, ?it/s]










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]













100%|██████████| 27/27 [00:29<00:00,  1.11s/it]
Epoch: 14 | Train Loss: 0.0023166904114065813 | Val Loss: 0.0025760598213377373 | Val Padded_cmAP : 0.7964056602921978










































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]











100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]










100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 16 | Train Loss: 0.0021196397281457464 | Val Loss: 0.002559308902601953 | Val Padded_cmAP : 0.8012966950829793











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]











100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:36<00:00,  1.01s/it]












100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
  0%|          | 0/154 [00:00<?, ?it/s]










































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]










100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]











100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
Epoch: 20 | Train Loss: 0.0018680007847074371 | Val Loss: 0.0026133525663883323 | Val Padded_cmAP : 0.8085057982340391












































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]












100%|██████████| 27/27 [00:29<00:00,  1.07s/it]
Epoch: 21 | Train Loss: 0.001785721425753232 | Val Loss: 0.0025063616447840577 | Val Padded_cmAP : 0.8133824661219952










































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:34<00:00,  1.01s/it]











 89%|████████▉ | 24/27 [00:26<00:02,  1.18it/s]
100%|██████████| 27/27 [00:28<00:00,  1.06s/it]











































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]










 89%|████████▉ | 24/27 [00:27<00:02,  1.38it/s]
100%|██████████| 27/27 [00:29<00:00,  1.09s/it]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]










 93%|█████████▎| 25/27 [00:28<00:01,  1.36it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]











100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 26 | Train Loss: 0.0015598716435034747 | Val Loss: 0.0025898548461824517 | Val Padded_cmAP : 0.8192313786992319










































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]











 96%|█████████▋| 26/27 [00:29<00:00,  1.53it/s]
100%|██████████| 27/27 [00:30<00:00,  1.12s/it]










































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]












 93%|█████████▎| 25/27 [00:28<00:01,  1.02it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]










































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]









100%|██████████| 27/27 [00:29<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]












100%|██████████| 27/27 [00:28<00:00,  1.61it/s]
Epoch: 30 | Train Loss: 0.0014514840811237016 | Val Loss: 0.002616941167852255 | Val Padded_cmAP : 0.8214367607573673
# Loading best model
100%|██████████| 27/27 [00:28<00:00,  1.07s/it]









100%|██████████| 27/27 [00:22<00:00,  1.18it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
>>> FOLD 1 Primary_Padded_cmAP = 0.871
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value






















wandb : 100%|██████████| 816/816 [00:44<00:00, 18.19it/s]