
  0%|          | 0/307 [00:00<?, ?it/s]
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 64 | Scheduler: cos
















































































































100%|██████████| 307/307 [03:53<00:00,  1.31it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 1 | Train Loss: 0.11342573517338897 | Val Loss: 0.008594948677691045 | Val Padded_cmAP : 0.47943467231746467

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








 96%|█████████▋| 26/27 [00:19<00:00,  2.11it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 3 | Train Loss: 0.004901588337756815 | Val Loss: 0.0059602744704871265 | Val Padded_cmAP : 0.48158079880004595

















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








 96%|█████████▋| 26/27 [00:19<00:00,  2.13it/s]
100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 6 | Train Loss: 0.003818929774067835 | Val Loss: 0.004549873363295639 | Val Padded_cmAP : 0.5210946795302781

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:50<00:00,  1.33it/s]








100%|██████████| 27/27 [00:21<00:00,  1.28it/s]
  0%|          | 0/307 [00:00<?, ?it/s]


















































































































100%|██████████| 307/307 [03:51<00:00,  1.33it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.33it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 20 | Train Loss: 0.0020288035189368874 | Val Loss: 0.0016977056188301907 | Val Padded_cmAP : 0.8434484656474348

















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








 93%|█████████▎| 25/27 [00:19<00:00,  2.01it/s]
100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 22 | Train Loss: 0.0019291798331613989 | Val Loss: 0.0015988355541291337 | Val Padded_cmAP : 0.8511879690292763

















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 23 | Train Loss: 0.0018747571115579201 | Val Loss: 0.0015341976282393767 | Val Padded_cmAP : 0.85680578379513

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.04it/s]
100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 25 | Train Loss: 0.0017889217205849211 | Val Loss: 0.0015520472510683317 | Val Padded_cmAP : 0.8615086740978848

















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 26 | Train Loss: 0.00176764740032244 | Val Loss: 0.0014878459677910778 | Val Padded_cmAP : 0.8652587218833339
Epoch: 27 | Train Loss: 0.0017195148249414631 | Val Loss: 0.0014541501694583093 | Val Padded_cmAP : 0.8693376465946981

















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 28 | Train Loss: 0.0016885644100994746 | Val Loss: 0.0013966163031808618 | Val Padded_cmAP : 0.8763546537908452

















































































































100%|██████████| 307/307 [03:49<00:00,  1.34it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.77it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
















































































































100%|██████████| 307/307 [03:48<00:00,  1.34it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 30 | Train Loss: 0.0016174981058105 | Val Loss: 0.0013695829537162488 | Val Padded_cmAP : 0.880730347538465
# Loading best model
# Infering OOF






 89%|████████▉ | 24/27 [00:12<00:01,  2.29it/s]
>>> FOLD 1 Padded_cmAP = 0.881
100%|██████████| 27/27 [00:14<00:00,  1.92it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value






















wandb : 100%|██████████| 802/802 [00:42<00:00, 18.77it/s]