#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381










































































100%|██████████| 154/154 [02:40<00:00,  1.04s/it]











100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
Epoch: 1 | Train Loss: 0.16512264666304766 | Val Loss: 0.00932395892838637 | Val Padded_cmAP : 0.4535156407821005












































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]












 96%|█████████▋| 26/27 [00:28<00:00,  1.31it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]











100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
Epoch: 3 | Train Loss: 0.006770043089598804 | Val Loss: 0.006942212081479805 | Val Padded_cmAP : 0.45542675047974956











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]











100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
Epoch: 4 | Train Loss: 0.005941288216136299 | Val Loss: 0.009067254347933663 | Val Padded_cmAP : 0.45665457755213795











































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]












 96%|█████████▋| 26/27 [00:29<00:00,  1.24it/s]
100%|██████████| 27/27 [00:29<00:00,  1.11s/it]











































































100%|██████████| 154/154 [02:37<00:00,  1.03s/it]









100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 7 | Train Loss: 0.005065208697062615 | Val Loss: 0.00564782017910922 | Val Padded_cmAP : 0.4818121275479047











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












 93%|█████████▎| 25/27 [00:28<00:01,  1.42it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]













































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]












100%|██████████| 27/27 [00:29<00:00,  1.08s/it]
Epoch: 9 | Train Loss: 0.004727563978015602 | Val Loss: 0.004872225380192201 | Val Padded_cmAP : 0.5253256527920644












































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 10 | Train Loss: 0.004520547591367519 | Val Loss: 0.004966146045329946 | Val Padded_cmAP : 0.5511339172669497











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]










 93%|█████████▎| 25/27 [00:27<00:01,  1.17it/s]
100%|██████████| 27/27 [00:28<00:00,  1.06s/it]












































































100%|██████████| 154/154 [02:40<00:00,  1.04s/it]












 96%|█████████▋| 26/27 [00:28<00:00,  1.30it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 13 | Train Loss: 0.003971588344301109 | Val Loss: 0.003807358391996887 | Val Padded_cmAP : 0.6254191172006882











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












100%|██████████| 27/27 [00:28<00:00,  1.73it/s]
100%|██████████| 27/27 [00:28<00:00,  1.07s/it]












































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]












 96%|█████████▋| 26/27 [00:28<00:00,  1.25it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]











































































100%|██████████| 154/154 [02:36<00:00,  1.01s/it]












 93%|█████████▎| 25/27 [00:28<00:01,  1.15it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]












































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]










 96%|█████████▋| 26/27 [00:28<00:00,  1.48it/s]
100%|██████████| 27/27 [00:28<00:00,  1.07s/it]













































































100%|██████████| 154/154 [02:39<00:00,  1.03s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 18 | Train Loss: 0.0032293677644489645 | Val Loss: 0.0030468108080741432 | Val Padded_cmAP : 0.7073880898395475











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]









 93%|█████████▎| 25/27 [00:28<00:01,  1.16it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












 96%|█████████▋| 26/27 [00:28<00:00,  1.32it/s]
100%|██████████| 27/27 [00:29<00:00,  1.08s/it]












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]










100%|██████████| 27/27 [00:30<00:00,  1.12s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:36<00:00,  1.01s/it]










100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]









100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]









100%|██████████| 27/27 [00:29<00:00,  1.08s/it]
  0%|          | 0/154 [00:00<?, ?it/s]












































































100%|██████████| 154/154 [02:39<00:00,  1.03s/it]












100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
Epoch: 25 | Train Loss: 0.0025790330663613683 | Val Loss: 0.002724111860583502 | Val Padded_cmAP : 0.7540619505547006












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]











100%|██████████| 27/27 [00:29<00:00,  1.08s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]









100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
  0%|          | 0/154 [00:00<?, ?it/s]













































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]











100%|██████████| 27/27 [00:29<00:00,  1.09s/it]
Epoch: 28 | Train Loss: 0.0024037552731377737 | Val Loss: 0.0026409251580911653 | Val Padded_cmAP : 0.7627738457289204











































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












100%|██████████| 27/27 [00:29<00:00,  1.08s/it]
  0%|          | 0/154 [00:00<?, ?it/s]












































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]












100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 30 | Train Loss: 0.0022969877607394735 | Val Loss: 0.002618726082059934 | Val Padded_cmAP : 0.767286658096985
# Loading best model
# Infering OOF









100%|██████████| 27/27 [00:28<00:00,  1.06s/it]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
>>> FOLD 1 Primary_Padded_cmAP = 0.817
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
































wandb : 100%|██████████| 1124/1124 [01:04<00:00, 17.43it/s]