
  0%|          | 0/316 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/multi_label/exp22_primary_label_2022_1st_like/fold-1.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 2 | Image Size: (128, 1001) | Model: tf_efficientnet_b1_ns | Batch Size: 64 | Scheduler: cos

















































































































































100%|██████████| 316/316 [05:12<00:00,  1.01it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 1 | Train Loss: 0.22423111496469642 | Val Loss: 0.08446008434381198 | Val Padded_cmAP : 0.8921095793711817


















































































































































100%|██████████| 316/316 [05:01<00:00,  1.05it/s]










100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
Epoch: 2 | Train Loss: 0.18187572679753544 | Val Loss: 0.08113006226442478 | Val Padded_cmAP : 0.8975717773131983




















































































































































100%|██████████| 316/316 [05:03<00:00,  1.04it/s]









 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]


















































































































































100%|██████████| 316/316 [05:07<00:00,  1.03it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 4 | Train Loss: 0.17608404223205923 | Val Loss: 0.0802064548694977 | Val Padded_cmAP : 0.8980060579983331














































































































































100%|██████████| 316/316 [04:56<00:00,  1.06it/s]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]
















































































































































100%|██████████| 316/316 [04:56<00:00,  1.06it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 6 | Train Loss: 0.1667241024301399 | Val Loss: 0.0826426292942078 | Val Padded_cmAP : 0.8989529510331641


















































































































































100%|██████████| 316/316 [05:00<00:00,  1.05it/s]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]











































































































































100%|██████████| 316/316 [04:47<00:00,  1.10it/s]










 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.23it/s]












































































































































100%|██████████| 316/316 [04:51<00:00,  1.08it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]
















































































































































100%|██████████| 316/316 [04:58<00:00,  1.06it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]















































































































































100%|██████████| 316/316 [04:55<00:00,  1.07it/s]










100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
  0%|          | 0/316 [00:00<?, ?it/s]



















































































































































100%|██████████| 316/316 [05:07<00:00,  1.03it/s]










100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
  0%|          | 0/316 [00:00<?, ?it/s]















































































































































100%|██████████| 316/316 [04:56<00:00,  1.07it/s]










 96%|█████████▋| 26/27 [00:21<00:00,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]


















































































































































100%|██████████| 316/316 [05:00<00:00,  1.05it/s]










 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]


















































































































































100%|██████████| 316/316 [05:01<00:00,  1.05it/s]










100%|██████████| 27/27 [00:21<00:00,  1.68it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]





















































































































































100%|██████████| 316/316 [05:06<00:00,  1.03it/s]









100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
  0%|          | 0/316 [00:00<?, ?it/s]



















































































































































100%|██████████| 316/316 [05:04<00:00,  1.04it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 17 | Train Loss: 0.15373575225283828 | Val Loss: 0.07911789924320248 | Val Padded_cmAP : 0.9019330403245728


















































































































































100%|██████████| 316/316 [05:07<00:00,  1.03it/s]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 18 | Train Loss: 0.15286451396591302 | Val Loss: 0.08863865046037568 | Val Padded_cmAP : 0.8995902778934942

















































































































































100%|██████████| 316/316 [05:05<00:00,  1.03it/s]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]

















































































































































100%|██████████| 316/316 [05:14<00:00,  1.01it/s]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 20 | Train Loss: 0.15220245464315899 | Val Loss: 0.08518000778362707 | Val Padded_cmAP : 0.9002853637512251
# Loading best model










100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   3%|▎         | 19/745 [00:00<00:39, 18.20it/s]
>>> FOLD 2 Primary_Padded_cmAP = 0.902

























wandb : 100%|██████████| 745/745 [00:51<00:00, 14.53it/s]