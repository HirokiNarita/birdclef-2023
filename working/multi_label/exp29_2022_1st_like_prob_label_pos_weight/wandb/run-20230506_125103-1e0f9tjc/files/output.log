
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_horizontalflip/fold-0.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos




































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 1 | Train Loss: 0.27122165070991816 | Val Loss: 0.00626715531365739 | Val Padded_cmAP : 0.48123478921514345





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








 93%|█████████▎| 25/27 [00:19<00:01,  1.97it/s]
100%|██████████| 27/27 [00:20<00:00,  1.34it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 3 | Train Loss: 0.005798737427776123 | Val Loss: 0.0060729762642747825 | Val Padded_cmAP : 0.4824988004027766





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
Epoch: 5 | Train Loss: 0.004863137884259031 | Val Loss: 0.005308372468722088 | Val Padded_cmAP : 0.5012616745416885






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 6 | Train Loss: 0.004521488429760778 | Val Loss: 0.004830038054259839 | Val Padded_cmAP : 0.5227584710570771





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 7 | Train Loss: 0.004159983575598083 | Val Loss: 0.004167846623911626 | Val Padded_cmAP : 0.5533626516276042




































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:20<00:00,  2.56it/s]
100%|██████████| 27/27 [00:20<00:00,  1.33it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  2.49it/s]
100%|██████████| 27/27 [00:19<00:00,  1.35it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]








100%|██████████| 27/27 [00:20<00:00,  1.29it/s]
Epoch: 14 | Train Loss: 0.0022401975032377555 | Val Loss: 0.0021810244393741917 | Val Padded_cmAP : 0.8017416467475046




































































100%|██████████| 154/154 [02:21<00:00,  1.09it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 18 | Train Loss: 0.001624508416915143 | Val Loss: 0.001823410139574359 | Val Padded_cmAP : 0.8399304611441838





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 21 | Train Loss: 0.0013261408433197187 | Val Loss: 0.0017979324070943727 | Val Padded_cmAP : 0.8518760576931952





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]







100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 28 | Train Loss: 0.0010102845100208198 | Val Loss: 0.0019010754800142928 | Val Padded_cmAP : 0.863698852642086





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.86it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  2.49it/s]
Epoch: 30 | Train Loss: 0.0009578481908470344 | Val Loss: 0.0019297022005991527 | Val Padded_cmAP : 0.8638045706943054
# Loading best model
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]







100%|██████████| 27/27 [00:16<00:00,  2.71it/s]
>>> FOLD 1 Primary_Padded_cmAP = 0.864
100%|██████████| 27/27 [00:16<00:00,  1.66it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value


























wandb : 100%|██████████| 814/814 [00:52<00:00, 15.49it/s]