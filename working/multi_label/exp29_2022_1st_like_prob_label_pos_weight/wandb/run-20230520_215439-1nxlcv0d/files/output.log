
  0%|          | 0/316 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/multi_label/exp22_primary_label_2022_1st_like/fold-3.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 4 | Image Size: (128, 1001) | Model: tf_efficientnet_b1_ns | Batch Size: 64 | Scheduler: cos
























































































































































100%|██████████| 316/316 [05:23<00:00,  1.02s/it]









100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
  0%|          | 0/316 [00:00<?, ?it/s]























































































































































100%|██████████| 316/316 [05:22<00:00,  1.02s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 2 | Train Loss: 0.1851486615082131 | Val Loss: 0.08729664222509773 | Val Padded_cmAP : 0.8839276839644303

































































































































































100%|██████████| 316/316 [05:30<00:00,  1.05s/it]









 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]































































































































































100%|██████████| 316/316 [05:41<00:00,  1.08s/it]









 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
































































































































































100%|██████████| 316/316 [05:42<00:00,  1.08s/it]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]





























































































































































100%|██████████| 316/316 [05:46<00:00,  1.10s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 6 | Train Loss: 0.17114149670623527 | Val Loss: 0.08296761344428416 | Val Padded_cmAP : 0.8880524033434475





























































































































































100%|██████████| 316/316 [05:51<00:00,  1.11s/it]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]































































































































































100%|██████████| 316/316 [05:49<00:00,  1.11s/it]









 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
































































































































































100%|██████████| 316/316 [05:50<00:00,  1.11s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]
































































































































































100%|██████████| 316/316 [05:51<00:00,  1.11s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
Epoch: 10 | Train Loss: 0.1623778119447488 | Val Loss: 0.09553908880937982 | Val Padded_cmAP : 0.8888076992839818


































































































































































100%|██████████| 316/316 [05:49<00:00,  1.11s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]



































































































































































100%|██████████| 316/316 [05:49<00:00,  1.11s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]
































































































































































100%|██████████| 316/316 [05:54<00:00,  1.12s/it]










100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]





































































































































































100%|██████████| 316/316 [05:53<00:00,  1.12s/it]










100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
Epoch: 14 | Train Loss: 0.1563860297297375 | Val Loss: 0.0900129262978832 | Val Padded_cmAP : 0.8903055556043912






































































































































































100%|██████████| 316/316 [05:52<00:00,  1.11s/it]









 89%|████████▉ | 24/27 [00:19<00:02,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]




































































































































































100%|██████████| 316/316 [06:01<00:00,  1.14s/it]









 93%|█████████▎| 25/27 [00:20<00:01,  1.39it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]







































































































































































100%|██████████| 316/316 [06:02<00:00,  1.15s/it]










 96%|█████████▋| 26/27 [00:21<00:00,  1.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]




































































































































































100%|██████████| 316/316 [06:01<00:00,  1.14s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/316 [00:00<?, ?it/s]



































































































































































100%|██████████| 316/316 [06:00<00:00,  1.14s/it]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/316 [00:00<?, ?it/s]


































































































































































100%|██████████| 316/316 [06:03<00:00,  1.15s/it]









 93%|█████████▎| 25/27 [00:20<00:01,  1.40it/s]
Epoch: 20 | Train Loss: 0.15406100136003917 | Val Loss: 0.08435827421231402 | Val Padded_cmAP : 0.8908922311205543
# Loading best model
100%|██████████| 27/27 [00:21<00:00,  1.25it/s]










100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
>>> FOLD 4 Primary_Padded_cmAP = 0.892
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value























wandb : 100%|██████████| 751/751 [00:47<00:00, 15.91it/s]