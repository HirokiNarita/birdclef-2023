load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
  0%|          | 0/154 [00:00<?, ?it/s]
#########################
#### Training
#### Fold: 5 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 1 | Train Loss: 0.28979439057361384 | Val Loss: 0.007133511878136132 | Val Padded_cmAP : 0.45572189306302213


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 2 | Train Loss: 0.008490039486220324 | Val Loss: 0.008436205762403982 | Val Padded_cmAP : 0.45626404515499097



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.93it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 4 | Train Loss: 0.006049842014304036 | Val Loss: 0.006537324559219458 | Val Padded_cmAP : 0.46292817539174574



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.10it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 7 | Train Loss: 0.005006136439208474 | Val Loss: 0.004879581979130981 | Val Padded_cmAP : 0.5168867732997042



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 8 | Train Loss: 0.0047306100136370625 | Val Loss: 0.004508660657814256 | Val Padded_cmAP : 0.5516213629538578



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  2.52it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 11 | Train Loss: 0.004064731094260495 | Val Loss: 0.0036720918163795162 | Val Padded_cmAP : 0.6689481717753815



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 13 | Train Loss: 0.0036509613001525594 | Val Loss: 0.003248993975662247 | Val Padded_cmAP : 0.7155833728510934



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 14 | Train Loss: 0.003437482063997198 | Val Loss: 0.0031198131230970225 | Val Padded_cmAP : 0.7411811853300226



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 15 | Train Loss: 0.0032605253153952297 | Val Loss: 0.0029830081190017088 | Val Padded_cmAP : 0.7496306502418488



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 16 | Train Loss: 0.0031467280547170864 | Val Loss: 0.0028590792876288847 | Val Padded_cmAP : 0.7618302735233763


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 18 | Train Loss: 0.002902704027977276 | Val Loss: 0.002716390450519544 | Val Padded_cmAP : 0.7775457342573684




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 20 | Train Loss: 0.0026704489961024615 | Val Loss: 0.002598688508711617 | Val Padded_cmAP : 0.7880865967437853



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.99it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.05it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 27 | Train Loss: 0.0022553685544566674 | Val Loss: 0.0023935354224199224 | Val Padded_cmAP : 0.8093070982113004



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 28 | Train Loss: 0.0022219113473381314 | Val Loss: 0.002356442691827262 | Val Padded_cmAP : 0.8129786526006628



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.99it/s]
Epoch: 30 | Train Loss: 0.0021481126873427398 | Val Loss: 0.002330013848323789 | Val Padded_cmAP : 0.8147486928703929
# Loading best model
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]







100%|██████████| 27/27 [00:14<00:00,  1.92it/s]
>>> FOLD 5 Primary_Padded_cmAP = 0.860
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value























wandb : 100%|██████████| 854/854 [00:47<00:00, 18.09it/s]