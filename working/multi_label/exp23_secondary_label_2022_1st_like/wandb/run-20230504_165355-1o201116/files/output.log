load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381


































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:20<00:00,  2.45it/s]
100%|██████████| 27/27 [00:20<00:00,  1.33it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.01it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]




































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:20<00:00,  1.31it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 4 | Train Loss: 0.006004850307552071 | Val Loss: 0.0065914371430321975 | Val Padded_cmAP : 0.46119616211802245



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]









100%|██████████| 27/27 [00:20<00:00,  1.31it/s]
Epoch: 5 | Train Loss: 0.005659025628119707 | Val Loss: 0.006119247318969833 | Val Padded_cmAP : 0.47272355187339254



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 6 | Train Loss: 0.005314633307688228 | Val Loss: 0.005562813167839691 | Val Padded_cmAP : 0.4926619798683438



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 8 | Train Loss: 0.004707105088882245 | Val Loss: 0.004683531186957326 | Val Padded_cmAP : 0.5404851410334346



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
Epoch: 10 | Train Loss: 0.004279667091277706 | Val Loss: 0.00445567570730216 | Val Padded_cmAP : 0.591118879441801



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 13 | Train Loss: 0.0036696916651706418 | Val Loss: 0.0033222005952632536 | Val Padded_cmAP : 0.7039388898424288


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 14 | Train Loss: 0.003476261385027077 | Val Loss: 0.0033905473623976664 | Val Padded_cmAP : 0.7144178627292925


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 16 | Train Loss: 0.0031623200471089644 | Val Loss: 0.0032971448791040865 | Val Padded_cmAP : 0.7422067521928882


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]









100%|██████████| 27/27 [00:21<00:00,  1.26it/s]
Epoch: 23 | Train Loss: 0.0024854368137123134 | Val Loss: 0.0027429695344633525 | Val Padded_cmAP : 0.7901562242997062



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 24 | Train Loss: 0.002412204645035861 | Val Loss: 0.003095193925589599 | Val Padded_cmAP : 0.7695203015090796



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:19<00:00,  2.01it/s]
100%|██████████| 27/27 [00:20<00:00,  1.33it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  2.60it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 27 | Train Loss: 0.002247025452360704 | Val Loss: 0.0024384766735171003 | Val Padded_cmAP : 0.8089049761542993



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:19<00:01,  1.88it/s]
100%|██████████| 27/27 [00:20<00:00,  1.33it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.12it/s]
100%|██████████| 27/27 [00:19<00:00,  1.42it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 89%|████████▉ | 24/27 [00:19<00:01,  1.88it/s]
Epoch: 30 | Train Loss: 0.0021159593182216796 | Val Loss: 0.0024113125185033788 | Val Padded_cmAP : 0.812081489022987
# Loading best model

100%|██████████| 27/27 [00:20<00:00,  1.32it/s]






 89%|████████▉ | 24/27 [00:13<00:01,  2.21it/s]
>>> FOLD 1 Primary_Padded_cmAP = 0.867
100%|██████████| 27/27 [00:14<00:00,  1.84it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value






















wandb : 100%|██████████| 801/801 [00:46<00:00, 17.20it/s]