load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'bn0.num_batches_tracked', 'model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 512) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381



























































100%|██████████| 154/154 [02:05<00:00,  1.23it/s]






 93%|█████████▎| 25/27 [00:14<00:00,  2.48it/s]
100%|██████████| 27/27 [00:14<00:00,  1.82it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
Epoch: 2 | Train Loss: 0.008554741047782364 | Val Loss: 0.008634048445081269 | Val Padded_cmAP : 0.45363431182256847



























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.48it/s]
100%|██████████| 27/27 [00:14<00:00,  1.87it/s]



























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:14<00:00,  1.88it/s]
Epoch: 4 | Train Loss: 0.00616652039544923 | Val Loss: 0.00689783544038181 | Val Padded_cmAP : 0.45688024777169356




























































100%|██████████| 154/154 [02:01<00:00,  1.26it/s]






100%|██████████| 27/27 [00:15<00:00,  1.80it/s]
Epoch: 5 | Train Loss: 0.005792933482942837 | Val Loss: 0.006504572117356239 | Val Padded_cmAP : 0.45917311256741483




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]





 85%|████████▌ | 23/27 [00:13<00:01,  2.34it/s]

100%|██████████| 27/27 [00:14<00:00,  1.86it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
Epoch: 7 | Train Loss: 0.00529321134634703 | Val Loss: 0.006078007924198 | Val Padded_cmAP : 0.4703440083741474




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
Epoch: 8 | Train Loss: 0.005131619537926533 | Val Loss: 0.005660792709224754 | Val Padded_cmAP : 0.4821683449162228




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:15<00:00,  1.79it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
Epoch: 10 | Train Loss: 0.004744725501430886 | Val Loss: 0.004998365736187056 | Val Padded_cmAP : 0.5229990943372156




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:15<00:00,  1.80it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
Epoch: 12 | Train Loss: 0.004363535944215179 | Val Loss: 0.004336963368890186 | Val Padded_cmAP : 0.570948268834534




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  3.05it/s]
100%|██████████| 27/27 [00:14<00:00,  1.83it/s]



























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






100%|██████████| 27/27 [00:14<00:00,  3.04it/s]
100%|██████████| 27/27 [00:14<00:00,  1.83it/s]




























































100%|██████████| 154/154 [02:04<00:00,  1.24it/s]






 96%|█████████▋| 26/27 [00:14<00:00,  2.52it/s]
100%|██████████| 27/27 [00:14<00:00,  1.82it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






 96%|█████████▋| 26/27 [00:14<00:00,  2.51it/s]
100%|██████████| 27/27 [00:15<00:00,  1.77it/s]




























































100%|██████████| 154/154 [02:04<00:00,  1.24it/s]






100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
Epoch: 18 | Train Loss: 0.0034539297997177422 | Val Loss: 0.0033686718455067386 | Val Padded_cmAP : 0.6977759278101815





























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]





100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
Epoch: 20 | Train Loss: 0.003226551676302084 | Val Loss: 0.00324562481061245 | Val Padded_cmAP : 0.7208759073398133




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:15<00:00,  1.77it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.82it/s]
Epoch: 22 | Train Loss: 0.0029981804515731023 | Val Loss: 0.003041142856495248 | Val Padded_cmAP : 0.7372715963762789





























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






100%|██████████| 27/27 [00:15<00:00,  1.77it/s]
Epoch: 23 | Train Loss: 0.002902505299463481 | Val Loss: 0.0030419446691801705 | Val Padded_cmAP : 0.7423906507964476





























































100%|██████████| 154/154 [02:04<00:00,  1.24it/s]






100%|██████████| 27/27 [00:14<00:00,  1.84it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






100%|██████████| 27/27 [00:15<00:00,  1.77it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






 96%|█████████▋| 26/27 [00:14<00:00,  2.49it/s]
100%|██████████| 27/27 [00:14<00:00,  1.86it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:15<00:00,  1.73it/s]
Epoch: 27 | Train Loss: 0.0026384980263575524 | Val Loss: 0.002770996712907045 | Val Padded_cmAP : 0.7648831589715515



























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.83it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.81it/s]
Epoch: 29 | Train Loss: 0.002522430653296798 | Val Loss: 0.0027459071737852086 | Val Padded_cmAP : 0.7699742387644312




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.0024639774301367535 | Val Loss: 0.0027257685109765995 | Val Padded_cmAP : 0.7712057523283051
# Loading best model





100%|██████████| 27/27 [00:12<00:00,  2.19it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 0/1084 [00:00<?, ?it/s]
>>> FOLD 1 Primary_Padded_cmAP = 0.823
































wandb : 100%|██████████| 1084/1084 [01:03<00:00, 17.11it/s]