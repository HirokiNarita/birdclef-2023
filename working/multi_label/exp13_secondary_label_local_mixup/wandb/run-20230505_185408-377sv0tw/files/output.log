
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'bn0.num_batches_tracked', 'model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 3 | Image Size: (224, 512) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 2 | Train Loss: 0.008531575236324366 | Val Loss: 0.008389886951556912 | Val Padded_cmAP : 0.45348249211037095




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  3.03it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]







100%|██████████| 27/27 [00:14<00:00,  1.86it/s]
Epoch: 4 | Train Loss: 0.006147003142985624 | Val Loss: 0.0067926907428988706 | Val Padded_cmAP : 0.4560189315089932




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.45it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 6 | Train Loss: 0.0055003065688463 | Val Loss: 0.006204782829930385 | Val Padded_cmAP : 0.46052296601779225




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.94it/s]
Epoch: 7 | Train Loss: 0.005339088774128974 | Val Loss: 0.005982120383392881 | Val Padded_cmAP : 0.46751593535375136





























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






100%|██████████| 27/27 [00:13<00:00,  3.03it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]





























































100%|██████████| 154/154 [02:04<00:00,  1.24it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.48it/s]
100%|██████████| 27/27 [00:13<00:00,  2.02it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
Epoch: 10 | Train Loss: 0.004773542665961114 | Val Loss: 0.005262663299045353 | Val Padded_cmAP : 0.5098816420251109




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.96it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 15 | Train Loss: 0.003934364035640928 | Val Loss: 0.0038739051799186403 | Val Padded_cmAP : 0.6318013642015922




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.53it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
Epoch: 20 | Train Loss: 0.003297771553980646 | Val Loss: 0.0033086035098811545 | Val Padded_cmAP : 0.7023115073024716




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 21 | Train Loss: 0.0031927748773754997 | Val Loss: 0.0033681878595854396 | Val Padded_cmAP : 0.7122681048589571




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 22 | Train Loss: 0.003060115673639751 | Val Loss: 0.0031201286991644236 | Val Padded_cmAP : 0.7299157876866014




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 23 | Train Loss: 0.002985562583395316 | Val Loss: 0.0031074150594779188 | Val Padded_cmAP : 0.7356647955310276




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 24 | Train Loss: 0.0029292234050279312 | Val Loss: 0.0030958278070169465 | Val Padded_cmAP : 0.7371910880569557




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.03it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 27 | Train Loss: 0.002700193476705969 | Val Loss: 0.002815972856263182 | Val Padded_cmAP : 0.7578246147923324




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.0025325266828808883 | Val Loss: 0.0027873851962525536 | Val Padded_cmAP : 0.7658804938051411
# Loading best model





100%|██████████| 27/27 [00:11<00:00,  2.34it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 4/1132 [00:00<00:37, 29.83it/s]
>>> FOLD 3 Primary_Padded_cmAP = 0.815
































wandb : 100%|██████████| 1132/1132 [01:04<00:00, 17.67it/s]