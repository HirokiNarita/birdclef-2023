load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'bn0.num_batches_tracked', 'model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 2 | Image Size: (224, 512) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,629 | Num Valid: 3,382




























































100%|██████████| 154/154 [02:04<00:00,  1.24it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 1 | Train Loss: 0.3296286430717869 | Val Loss: 0.009121317795857235 | Val Padded_cmAP : 0.4528969599620333




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 3 | Train Loss: 0.006839915589949527 | Val Loss: 0.007527554942363942 | Val Padded_cmAP : 0.4552234385111174




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 4 | Train Loss: 0.0062014303508807316 | Val Loss: 0.006923459349545064 | Val Padded_cmAP : 0.45670538809436567




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.46it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]



























































100%|██████████| 154/154 [02:01<00:00,  1.26it/s]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 7 | Train Loss: 0.005326513228212278 | Val Loss: 0.005945602224932777 | Val Padded_cmAP : 0.47390188386292764




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 89%|████████▉ | 24/27 [00:12<00:01,  2.43it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:14<00:00,  1.87it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.51it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.48it/s]
100%|██████████| 27/27 [00:13<00:00,  1.96it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]





100%|██████████| 27/27 [00:13<00:00,  2.03it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 14 | Train Loss: 0.004066635632294823 | Val Loss: 0.003978585324215668 | Val Padded_cmAP : 0.6307768163791642




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 15 | Train Loss: 0.0038891409148837067 | Val Loss: 0.0038737495024516073 | Val Padded_cmAP : 0.6522445097155317




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.53it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 18 | Train Loss: 0.003442824919490361 | Val Loss: 0.003317484334628615 | Val Padded_cmAP : 0.7038146317330335




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.04it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
Epoch: 20 | Train Loss: 0.003235523133877326 | Val Loss: 0.0031290092953929196 | Val Padded_cmAP : 0.7275227030100159




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  3.02it/s]
100%|██████████| 27/27 [00:13<00:00,  2.02it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.02it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.0025214726111379925 | Val Loss: 0.0027218302280676587 | Val Padded_cmAP : 0.7764289537917891
# Loading best model





100%|██████████| 27/27 [00:11<00:00,  2.39it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   1%|          | 12/1092 [00:00<00:40, 26.50it/s]
>>> FOLD 2 Primary_Padded_cmAP = 0.827


































wandb : 100%|██████████| 1092/1092 [01:09<00:00, 15.78it/s]