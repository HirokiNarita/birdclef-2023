
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'bn0.num_batches_tracked', 'model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 5 | Image Size: (224, 512) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.44it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 2 | Train Loss: 0.008604168773979529 | Val Loss: 0.008494691923260689 | Val Padded_cmAP : 0.45490705107414764




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 3 | Train Loss: 0.0068791765483797755 | Val Loss: 0.007528687585835104 | Val Padded_cmAP : 0.45677558939466645




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.47it/s]
100%|██████████| 27/27 [00:13<00:00,  1.96it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 5 | Train Loss: 0.0057744548789092475 | Val Loss: 0.006541571631613705 | Val Padded_cmAP : 0.45946072119407116




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]





 89%|████████▉ | 24/27 [00:12<00:01,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  3.03it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 8 | Train Loss: 0.005141977072608742 | Val Loss: 0.005698199159707184 | Val Padded_cmAP : 0.48402252936238216




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.45it/s]
100%|██████████| 27/27 [00:13<00:00,  1.95it/s]





























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
Epoch: 10 | Train Loss: 0.004823813121161097 | Val Loss: 0.004994392990031176 | Val Padded_cmAP : 0.5169903559542309




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 11 | Train Loss: 0.004637376677438423 | Val Loss: 0.0046686786916796804 | Val Padded_cmAP : 0.5354865180338078




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.03it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.53it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 14 | Train Loss: 0.00411784969717748 | Val Loss: 0.003920926294220543 | Val Padded_cmAP : 0.6096318219099667




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 18 | Train Loss: 0.0035479065142692877 | Val Loss: 0.003473477459650625 | Val Padded_cmAP : 0.6870482892997055





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.95it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.04it/s]
Epoch: 20 | Train Loss: 0.0032801993263812806 | Val Loss: 0.003323694882931671 | Val Padded_cmAP : 0.6991621360849918




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 21 | Train Loss: 0.003195546526619076 | Val Loss: 0.003159128414053056 | Val Padded_cmAP : 0.7183427498243111




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.95it/s]
Epoch: 22 | Train Loss: 0.0031226017473072005 | Val Loss: 0.003080599275158925 | Val Padded_cmAP : 0.7258865888552588




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]







100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
Epoch: 23 | Train Loss: 0.0030191782816591396 | Val Loss: 0.003074982319958508 | Val Padded_cmAP : 0.7364761934085943



























































100%|██████████| 154/154 [02:04<00:00,  1.24it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 89%|████████▉ | 24/27 [00:12<00:01,  2.40it/s]
100%|██████████| 27/27 [00:13<00:00,  1.98it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]







100%|██████████| 27/27 [00:15<00:00,  1.79it/s]
Epoch: 29 | Train Loss: 0.0026012147949137665 | Val Loss: 0.0027208049238349 | Val Padded_cmAP : 0.7627820361367591




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





 85%|████████▌ | 23/27 [00:12<00:01,  2.32it/s]
Epoch: 30 | Train Loss: 0.002586597501898983 | Val Loss: 0.0027404530124773307 | Val Padded_cmAP : 0.7627261384128531
# Loading best model
100%|██████████| 27/27 [00:13<00:00,  1.96it/s]





 85%|████████▌ | 23/27 [00:09<00:01,  2.58it/s]
>>> FOLD 5 Primary_Padded_cmAP = 0.807
100%|██████████| 27/27 [00:11<00:00,  2.36it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
































wandb : 100%|██████████| 1158/1158 [01:03<00:00, 18.16it/s]