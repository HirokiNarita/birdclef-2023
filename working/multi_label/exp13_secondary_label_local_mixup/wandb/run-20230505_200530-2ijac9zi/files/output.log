load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['bn0.weight', 'bn0.bias', 'bn0.running_mean', 'bn0.running_var', 'bn0.num_batches_tracked', 'model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 4 | Image Size: (224, 512) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,623 | Num Valid: 3,381




























































100%|██████████| 154/154 [02:03<00:00,  1.24it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 1 | Train Loss: 0.34118481545237367 | Val Loss: 0.009208047417578873 | Val Padded_cmAP : 0.4563454014489362




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.46it/s]
100%|██████████| 27/27 [00:13<00:00,  1.99it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 3 | Train Loss: 0.006828319054556551 | Val Loss: 0.007402424683311471 | Val Padded_cmAP : 0.4580057937850542




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 5 | Train Loss: 0.005801574088173446 | Val Loss: 0.006492038102199634 | Val Padded_cmAP : 0.46136914574026927




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]







100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 6 | Train Loss: 0.005525235256010836 | Val Loss: 0.006216388868374957 | Val Padded_cmAP : 0.46621803452455624




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]






 89%|████████▉ | 24/27 [00:12<00:01,  2.39it/s]
100%|██████████| 27/27 [00:13<00:00,  1.95it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  3.03it/s]
100%|██████████| 27/27 [00:13<00:00,  1.97it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.26it/s]





100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.50it/s]
100%|██████████| 27/27 [00:13<00:00,  1.96it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
Epoch: 11 | Train Loss: 0.004602668637579138 | Val Loss: 0.004630498372501245 | Val Padded_cmAP : 0.548402357444264




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 12 | Train Loss: 0.004435291991557007 | Val Loss: 0.004322402084384252 | Val Padded_cmAP : 0.5685328968027751




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
Epoch: 13 | Train Loss: 0.004253097880909873 | Val Loss: 0.00407745616717471 | Val Padded_cmAP : 0.5989548040918746




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:13<00:00,  2.42it/s]
100%|██████████| 27/27 [00:13<00:00,  1.96it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.95it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.41it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  3.02it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 20 | Train Loss: 0.0032267715727499167 | Val Loss: 0.0031218362101181237 | Val Padded_cmAP : 0.7190930311740237




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 21 | Train Loss: 0.0031452472261213637 | Val Loss: 0.003039669642155921 | Val Padded_cmAP : 0.7304195032748725




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 22 | Train Loss: 0.0030154585399870554 | Val Loss: 0.003061829393522607 | Val Padded_cmAP : 0.7409265421372292




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.95it/s]
Epoch: 23 | Train Loss: 0.0029292795867598676 | Val Loss: 0.0029528567791674977 | Val Padded_cmAP : 0.7478147140626004




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.98it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:02<00:00,  1.25it/s]






 96%|█████████▋| 26/27 [00:13<00:00,  2.50it/s]
100%|██████████| 27/27 [00:13<00:00,  2.00it/s]





























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
Epoch: 26 | Train Loss: 0.0027275390910928127 | Val Loss: 0.002811025396955234 | Val Padded_cmAP : 0.76003101752722




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
Epoch: 27 | Train Loss: 0.002646900193354526 | Val Loss: 0.002800700453075546 | Val Padded_cmAP : 0.7638230665600254




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.95it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]





100%|██████████| 27/27 [00:13<00:00,  2.00it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




























































100%|██████████| 154/154 [02:03<00:00,  1.25it/s]






100%|██████████| 27/27 [00:13<00:00,  1.99it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.002493059083474679 | Val Loss: 0.0027115857832271744 | Val Padded_cmAP : 0.7724811876088449
# Loading best model





100%|██████████| 27/27 [00:11<00:00,  2.36it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 0/1069 [00:00<?, ?it/s]
>>> FOLD 4 Primary_Padded_cmAP = 0.819





























wandb : 100%|██████████| 1069/1069 [00:58<00:00, 18.39it/s]