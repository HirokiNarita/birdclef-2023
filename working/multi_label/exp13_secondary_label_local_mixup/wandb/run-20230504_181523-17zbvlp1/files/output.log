load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
  0%|          | 0/154 [00:00<?, ?it/s]
#########################
#### Training
#### Fold: 2 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos




































































100%|██████████| 154/154 [02:19<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 1 | Train Loss: 0.2909974037403507 | Val Loss: 0.007205002820464196 | Val Padded_cmAP : 0.45375400944501343



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 2 | Train Loss: 0.008548601158568031 | Val Loss: 0.008764016200546865 | Val Padded_cmAP : 0.45399418248662576


































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 3 | Train Loss: 0.006803966136407349 | Val Loss: 0.007335565587574685 | Val Padded_cmAP : 0.45634610700477224



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 5 | Train Loss: 0.005669147314431218 | Val Loss: 0.0062522225219894334 | Val Padded_cmAP : 0.469288753256456



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 6 | Train Loss: 0.005346726435659962 | Val Loss: 0.005867170135456103 | Val Padded_cmAP : 0.48990562073154376


































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 7 | Train Loss: 0.005023391297474117 | Val Loss: 0.005086647536329649 | Val Padded_cmAP : 0.5144783268437388



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]









100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 8 | Train Loss: 0.004767916691429042 | Val Loss: 0.00472365116217622 | Val Padded_cmAP : 0.542879745846014



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 9 | Train Loss: 0.004537867758628707 | Val Loss: 0.004523525945842266 | Val Padded_cmAP : 0.5812114760585982



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 10 | Train Loss: 0.004299078809472358 | Val Loss: 0.004040712382885869 | Val Padded_cmAP : 0.6159830350184974



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 12 | Train Loss: 0.0038773335725093235 | Val Loss: 0.003624117907343639 | Val Padded_cmAP : 0.6700615107146188


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 15 | Train Loss: 0.0033059913359654997 | Val Loss: 0.0031042273233955107 | Val Padded_cmAP : 0.7374250894106588



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 18 | Train Loss: 0.0029284977384347035 | Val Loss: 0.0027803376756815445 | Val Padded_cmAP : 0.7674233828680985



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 27 | Train Loss: 0.0022575465105050666 | Val Loss: 0.002546812694399031 | Val Padded_cmAP : 0.8024643707627824



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.0021500498987734318 | Val Loss: 0.002509753827729987 | Val Padded_cmAP : 0.8080329999889033
# Loading best model







100%|██████████| 27/27 [00:14<00:00,  1.93it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   3%|▎         | 31/906 [00:01<00:46, 18.95it/s]
>>> FOLD 2 Primary_Padded_cmAP = 0.859


























wandb : 100%|██████████| 906/906 [00:55<00:00, 16.31it/s]