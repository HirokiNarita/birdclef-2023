#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  2.57it/s]
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 2 | Train Loss: 0.007282215651342428 | Val Loss: 0.007397103795988692 | Val Padded_cmAP : 0.47956752558538807

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.89it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 4 | Train Loss: 0.005105495153527174 | Val Loss: 0.005854750707469604 | Val Padded_cmAP : 0.4833055978831413


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 5 | Train Loss: 0.0046959223086619145 | Val Loss: 0.005206990900828883 | Val Padded_cmAP : 0.4897197270717963


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 6 | Train Loss: 0.004402214180460417 | Val Loss: 0.004983985831064207 | Val Padded_cmAP : 0.5000216152150911

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 7 | Train Loss: 0.004172240755847329 | Val Loss: 0.008338277141943021 | Val Padded_cmAP : 0.5128788117765591

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.01it/s]
100%|██████████| 27/27 [00:19<00:00,  1.38it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 9 | Train Loss: 0.00382089669144918 | Val Loss: 0.0042167899319557126 | Val Padded_cmAP : 0.5636809078283904

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 10 | Train Loss: 0.0036606820052271925 | Val Loss: 0.003893018001690507 | Val Padded_cmAP : 0.5904519322072209

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]









100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 11 | Train Loss: 0.003491686099184701 | Val Loss: 0.0037161586547477376 | Val Padded_cmAP : 0.6147535366207948

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 13 | Train Loss: 0.003196196272279825 | Val Loss: 0.003247751129998101 | Val Padded_cmAP : 0.6645595360458089


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  2.58it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 15 | Train Loss: 0.0029184625774331683 | Val Loss: 0.002864940066097511 | Val Padded_cmAP : 0.7108412310536746

































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 16 | Train Loss: 0.0027979295519362023 | Val Loss: 0.002711667873275777 | Val Padded_cmAP : 0.7253950284850877

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 19 | Train Loss: 0.002474156639224233 | Val Loss: 0.0023443030659109354 | Val Padded_cmAP : 0.7664378399809672


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 20 | Train Loss: 0.0023821466662860536 | Val Loss: 0.0022709143016038944 | Val Padded_cmAP : 0.7736317557700921

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
Epoch: 22 | Train Loss: 0.00222565692262845 | Val Loss: 0.002067235583025548 | Val Padded_cmAP : 0.7937691930709262

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 23 | Train Loss: 0.002170696209015494 | Val Loss: 0.002047353512521281 | Val Padded_cmAP : 0.798750735181756

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]







100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.01it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]







100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







 93%|█████████▎| 25/27 [00:18<00:00,  2.04it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 33 | Train Loss: 0.0016855730519436494 | Val Loss: 0.0017321081832051277 | Val Padded_cmAP : 0.836892309327403


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 35 | Train Loss: 0.0016299493167875939 | Val Loss: 0.001695544282146902 | Val Padded_cmAP : 0.839009286715629
# Loading best model
# Infering OOF





100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
>>> FOLD 1 Primary_Padded_cmAP = 0.839
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value

























wandb : 100%|██████████| 1003/1003 [00:50<00:00, 19.87it/s]