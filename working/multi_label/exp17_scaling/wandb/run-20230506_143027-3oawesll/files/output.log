
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_horizontalflip/fold-0.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos






































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]









100%|██████████| 27/27 [00:21<00:00,  1.27it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]









100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
Epoch: 3 | Train Loss: 0.0058503791768490885 | Val Loss: 0.006142354553082475 | Val Padded_cmAP : 0.48235820784877115






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








 93%|█████████▎| 25/27 [00:19<00:01,  1.98it/s]
100%|██████████| 27/27 [00:19<00:00,  1.35it/s]








































































100%|██████████| 154/154 [02:29<00:00,  1.03it/s]







100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
Epoch: 6 | Train Loss: 0.00454085399457193 | Val Loss: 0.004798678465670458 | Val Padded_cmAP : 0.5192810856460437






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]









100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
Epoch: 7 | Train Loss: 0.004216852322728796 | Val Loss: 0.004273672687338182 | Val Padded_cmAP : 0.5427810661052886






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








 93%|█████████▎| 25/27 [00:19<00:01,  1.98it/s]
100%|██████████| 27/27 [00:20<00:00,  1.35it/s]






































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 9 | Train Loss: 0.0037174118613195303 | Val Loss: 0.0035223867830440955 | Val Padded_cmAP : 0.6215323934935477







































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]









100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 11 | Train Loss: 0.0032354996391487393 | Val Loss: 0.0029432154734860415 | Val Padded_cmAP : 0.7200176326511296







































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]







100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:20<00:00,  1.31it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 14 | Train Loss: 0.0025747542559810275 | Val Loss: 0.002222495556688281 | Val Padded_cmAP : 0.7989968563354619






































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]








































































100%|██████████| 154/154 [02:29<00:00,  1.03it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:28<00:00,  1.04it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:27<00:00,  1.04it/s]







100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:28<00:00,  1.04it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 20 | Train Loss: 0.001811966197202345 | Val Loss: 0.0017400206459030785 | Val Padded_cmAP : 0.8509943592012175







































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:27<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]








































































100%|██████████| 154/154 [02:29<00:00,  1.03it/s]







100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:27<00:00,  1.04it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 24 | Train Loss: 0.0015330081480531047 | Val Loss: 0.0015728659388885178 | Val Padded_cmAP : 0.8641519299579541






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:21<00:00,  1.25it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 28 | Train Loss: 0.0013768771382097107 | Val Loss: 0.001488212534847359 | Val Padded_cmAP : 0.8728071301152349






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 29 | Train Loss: 0.0013298500524289518 | Val Loss: 0.0015110438517122358 | Val Padded_cmAP : 0.872985517713984







































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]









100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
Epoch: 30 | Train Loss: 0.001309362333872682 | Val Loss: 0.001485163960347159 | Val Padded_cmAP : 0.8753146568084722
# Loading best model
# Infering OOF






 93%|█████████▎| 25/27 [00:13<00:00,  2.30it/s]
>>> FOLD 1 Primary_Padded_cmAP = 0.875
100%|██████████| 27/27 [00:14<00:00,  1.85it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value

























wandb : 100%|██████████| 776/776 [00:48<00:00, 15.86it/s]