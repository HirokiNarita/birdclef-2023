
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 4 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos




































































100%|██████████| 154/154 [02:19<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 1 | Train Loss: 0.29942889263030964 | Val Loss: 0.007224900130596425 | Val Padded_cmAP : 0.4563732510559861



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 2 | Train Loss: 0.008488165898030841 | Val Loss: 0.008361817941207576 | Val Padded_cmAP : 0.4571274258104369



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 96%|█████████▋| 26/27 [00:17<00:00,  2.08it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]









100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 4 | Train Loss: 0.006079370621591806 | Val Loss: 0.006611521562768353 | Val Padded_cmAP : 0.46312025414310926



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 5 | Train Loss: 0.005702171994784436 | Val Loss: 0.006215161678415758 | Val Padded_cmAP : 0.46835426637855804



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]









100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 6 | Train Loss: 0.005389714199299743 | Val Loss: 0.005662319543598978 | Val Padded_cmAP : 0.4904540238873235



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 7 | Train Loss: 0.005077426152473146 | Val Loss: 0.005090018078960755 | Val Padded_cmAP : 0.5198374933893026



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 9 | Train Loss: 0.004550143510901502 | Val Loss: 0.004728757026087906 | Val Padded_cmAP : 0.5537036134626128



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  2.54it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 11 | Train Loss: 0.004110889654461439 | Val Loss: 0.0036296739665515445 | Val Padded_cmAP : 0.6539620637350131


































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 14 | Train Loss: 0.0034722592923548314 | Val Loss: 0.00315808215075069 | Val Padded_cmAP : 0.7166025371110101



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 16 | Train Loss: 0.003171587161804465 | Val Loss: 0.002978335190736861 | Val Padded_cmAP : 0.7470561388297907



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 19 | Train Loss: 0.0028428356828434126 | Val Loss: 0.0026748423180025485 | Val Padded_cmAP : 0.7765547144232829



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 26 | Train Loss: 0.0023171944927738667 | Val Loss: 0.0025382819197451076 | Val Padded_cmAP : 0.8005334306197811



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 27 | Train Loss: 0.0022529568258588288 | Val Loss: 0.002509343116630421 | Val Padded_cmAP : 0.8041573117106293



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 29 | Train Loss: 0.0021628543897834304 | Val Loss: 0.0024535500409978406 | Val Padded_cmAP : 0.8073744277792878



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.91it/s]
Epoch: 30 | Train Loss: 0.00213637319393456 | Val Loss: 0.0024448153670635765 | Val Padded_cmAP : 0.8089141365948866
# Loading best model
100%|██████████| 27/27 [00:19<00:00,  1.42it/s]






100%|██████████| 27/27 [00:13<00:00,  1.97it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 0/869 [00:00<?, ?it/s]
>>> FOLD 4 Primary_Padded_cmAP = 0.858
























wandb : 100%|██████████| 869/869 [00:46<00:00, 18.55it/s]