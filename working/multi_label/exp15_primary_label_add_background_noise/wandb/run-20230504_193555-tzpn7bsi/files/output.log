load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 3 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,629 | Num Valid: 3,381



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.00it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 2 | Train Loss: 0.008449474201453004 | Val Loss: 0.008518231308294667 | Val Padded_cmAP : 0.4526922587300173



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
Epoch: 3 | Train Loss: 0.006758849275624985 | Val Loss: 0.0071293688034293826 | Val Padded_cmAP : 0.4559700390958453



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 4 | Train Loss: 0.006071390257543558 | Val Loss: 0.0065559230537878144 | Val Padded_cmAP : 0.45982153810125714



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.96it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 6 | Train Loss: 0.005364315675015187 | Val Loss: 0.005684212419307894 | Val Padded_cmAP : 0.4895077413577042



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 7 | Train Loss: 0.005079342124911098 | Val Loss: 0.005068158584267453 | Val Padded_cmAP : 0.5161686827511283




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.06it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 93%|█████████▎| 25/27 [00:17<00:01,  1.90it/s]
100%|██████████| 27/27 [00:18<00:00,  1.50it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
Epoch: 10 | Train Loss: 0.004275430899488365 | Val Loss: 0.004072038249837028 | Val Padded_cmAP : 0.6135075821476024



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 96%|█████████▋| 26/27 [00:17<00:00,  2.05it/s]
100%|██████████| 27/27 [00:18<00:00,  1.48it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 12 | Train Loss: 0.0038683920578619878 | Val Loss: 0.0035556543497713626 | Val Padded_cmAP : 0.6845846611302238



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  2.00it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 17 | Train Loss: 0.0030403011523840295 | Val Loss: 0.002896613333615716 | Val Padded_cmAP : 0.7563429758234079



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.92it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 19 | Train Loss: 0.00284195174735233 | Val Loss: 0.0027025300811079366 | Val Padded_cmAP : 0.7725450441899167



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 22 | Train Loss: 0.0025634464910616736 | Val Loss: 0.0025922662246523906 | Val Padded_cmAP : 0.7869211604668904




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 24 | Train Loss: 0.002456402991952786 | Val Loss: 0.0025561261594433476 | Val Padded_cmAP : 0.7931863535319017



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.0021455150087025354 | Val Loss: 0.0024305764667655306 | Val Padded_cmAP : 0.8080994277936444
# Loading best model






100%|██████████| 27/27 [00:13<00:00,  2.07it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   1%|          | 6/888 [00:00<00:44, 19.81it/s]
>>> FOLD 3 Primary_Padded_cmAP = 0.858

























wandb : 100%|██████████| 888/888 [00:49<00:00, 17.98it/s]