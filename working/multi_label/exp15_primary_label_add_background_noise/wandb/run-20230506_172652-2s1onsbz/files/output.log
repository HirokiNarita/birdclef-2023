load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_horizontalflip/fold-0.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381














































































































100%|██████████| 154/154 [10:19<00:00,  4.02s/it]








 89%|████████▉ | 24/27 [00:19<00:01,  1.73it/s]
100%|██████████| 27/27 [00:21<00:00,  1.26it/s]











































































































100%|██████████| 154/154 [10:03<00:00,  3.92s/it]









100%|██████████| 27/27 [00:21<00:00,  1.28it/s]
Epoch: 2 | Train Loss: 0.0073567422336668934 | Val Loss: 0.00742290039650268 | Val Padded_cmAP : 0.481255340020578







































































































100%|██████████| 154/154 [09:49<00:00,  3.83s/it]









 93%|█████████▎| 25/27 [00:21<00:01,  1.83it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]




































































































100%|██████████| 154/154 [09:57<00:00,  3.88s/it]









 93%|█████████▎| 25/27 [00:21<00:01,  1.81it/s]
100%|██████████| 27/27 [00:21<00:00,  1.23it/s]





































































































100%|██████████| 154/154 [09:55<00:00,  3.87s/it]









 96%|█████████▋| 26/27 [00:21<00:00,  1.89it/s]
100%|██████████| 27/27 [00:22<00:00,  1.23it/s]









































































































100%|██████████| 154/154 [10:03<00:00,  3.92s/it]









 93%|█████████▎| 25/27 [00:21<00:01,  1.83it/s]
100%|██████████| 27/27 [00:22<00:00,  1.22it/s]





























































































100%|██████████| 154/154 [10:12<00:00,  3.98s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
Epoch: 7 | Train Loss: 0.004276076782277071 | Val Loss: 0.004454637023930748 | Val Padded_cmAP : 0.5376983697242316













































































































100%|██████████| 154/154 [10:11<00:00,  3.97s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
Epoch: 8 | Train Loss: 0.004038014130170953 | Val Loss: 0.003925436672202691 | Val Padded_cmAP : 0.5647821540387552



























































































100%|██████████| 154/154 [10:11<00:00,  3.97s/it]









 96%|█████████▋| 26/27 [00:21<00:00,  1.94it/s]
100%|██████████| 27/27 [00:22<00:00,  1.22it/s]









































































































100%|██████████| 154/154 [09:41<00:00,  3.77s/it]









100%|██████████| 27/27 [00:22<00:00,  1.21it/s]
Epoch: 10 | Train Loss: 0.0036426797031437036 | Val Loss: 0.003342491854844546 | Val Padded_cmAP : 0.6530158242578182









































































































100%|██████████| 154/154 [09:50<00:00,  3.84s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


























































































100%|██████████| 154/154 [10:03<00:00,  3.92s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
Epoch: 12 | Train Loss: 0.0032150024871716834 | Val Loss: 0.002787181840243715 | Val Padded_cmAP : 0.7337513832753475


































































































100%|██████████| 154/154 [10:07<00:00,  3.94s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
Epoch: 13 | Train Loss: 0.003037426247285655 | Val Loss: 0.0024701245323133967 | Val Padded_cmAP : 0.7620191913772489


































































































100%|██████████| 154/154 [09:58<00:00,  3.88s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
Epoch: 14 | Train Loss: 0.0028384255453968396 | Val Loss: 0.0022717300862832752 | Val Padded_cmAP : 0.7811987667848119


































































































100%|██████████| 154/154 [10:09<00:00,  3.96s/it]









 93%|█████████▎| 25/27 [00:21<00:01,  1.61it/s]
100%|██████████| 27/27 [00:22<00:00,  1.20it/s]









































































































100%|██████████| 154/154 [09:35<00:00,  3.74s/it]










100%|██████████| 27/27 [00:22<00:00,  1.18it/s]
Epoch: 16 | Train Loss: 0.0025506679001929505 | Val Loss: 0.002055478715596514 | Val Padded_cmAP : 0.8115873971866991





































































































100%|██████████| 154/154 [09:59<00:00,  3.90s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
Epoch: 17 | Train Loss: 0.002428683759221299 | Val Loss: 0.0019228962267300598 | Val Padded_cmAP : 0.8227474001192543
















































































































100%|██████████| 154/154 [10:02<00:00,  3.91s/it]









 96%|█████████▋| 26/27 [00:21<00:00,  1.94it/s]
100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
































































































100%|██████████| 154/154 [10:07<00:00,  3.95s/it]









100%|██████████| 27/27 [00:21<00:00,  2.40it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]



















































































































100%|██████████| 154/154 [10:09<00:00,  3.96s/it]









100%|██████████| 27/27 [00:21<00:00,  2.35it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]

































































































100%|██████████| 154/154 [09:58<00:00,  3.89s/it]









100%|██████████| 27/27 [00:21<00:00,  1.26it/s]
  0%|          | 0/154 [00:00<?, ?it/s]









































































































100%|██████████| 154/154 [09:50<00:00,  3.83s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/154 [00:00<?, ?it/s]









































































































100%|██████████| 154/154 [09:59<00:00,  3.89s/it]









100%|██████████| 27/27 [00:21<00:00,  2.38it/s]
100%|██████████| 27/27 [00:21<00:00,  1.24it/s]





























































































100%|██████████| 154/154 [09:53<00:00,  3.86s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/154 [00:00<?, ?it/s]













































































































100%|██████████| 154/154 [10:13<00:00,  3.98s/it]









100%|██████████| 27/27 [00:22<00:00,  1.23it/s]
Epoch: 25 | Train Loss: 0.0018063213142518002 | Val Loss: 0.00161468220930719 | Val Padded_cmAP : 0.8587447050093336


































































































100%|██████████| 154/154 [09:37<00:00,  3.75s/it]








100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































































100%|██████████| 154/154 [09:45<00:00,  3.80s/it]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





























































































100%|██████████| 154/154 [10:11<00:00,  3.97s/it]









100%|██████████| 27/27 [00:21<00:00,  1.26it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































































100%|██████████| 154/154 [09:23<00:00,  3.66s/it]









100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































































100%|██████████| 154/154 [09:53<00:00,  3.85s/it]








100%|██████████| 27/27 [00:21<00:00,  1.24it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.001585511944268818 | Val Loss: 0.0014885546266601454 | Val Padded_cmAP : 0.870304949648917
# Loading best model






100%|██████████| 27/27 [00:13<00:00,  1.96it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   1%|          | 9/805 [00:01<01:09, 11.44it/s]
>>> FOLD 1 Primary_Padded_cmAP = 0.870





















wandb : 100%|██████████| 805/805 [00:43<00:00, 18.31it/s]