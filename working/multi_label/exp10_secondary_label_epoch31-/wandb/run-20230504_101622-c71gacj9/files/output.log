
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp1_pre_attblock_fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 2 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]












100%|██████████| 27/27 [00:27<00:00,  1.02s/it]
Epoch: 1 | Train Loss: 0.11078607668955025 | Val Loss: 0.008705962069884495 | Val Padded_cmAP : 0.4539234423225776










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]












100%|██████████| 27/27 [00:27<00:00,  1.82it/s]
100%|██████████| 27/27 [00:27<00:00,  1.02s/it]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]












100%|██████████| 27/27 [00:27<00:00,  1.01s/it]
Epoch: 3 | Train Loss: 0.0056335982781919565 | Val Loss: 0.0060401442978117205 | Val Padded_cmAP : 0.4642108667079417












































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]











100%|██████████| 27/27 [00:29<00:00,  1.07s/it]
Epoch: 4 | Train Loss: 0.005202966518458221 | Val Loss: 0.00543154986506259 | Val Padded_cmAP : 0.49146148097438014























































































100%|██████████| 154/154 [03:01<00:00,  1.18s/it]












100%|██████████| 27/27 [00:27<00:00,  1.02s/it]
Epoch: 5 | Train Loss: 0.0047835671651334346 | Val Loss: 0.004617065208515635 | Val Padded_cmAP : 0.5394570974002609











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]












100%|██████████| 27/27 [00:27<00:00,  1.02s/it]
Epoch: 6 | Train Loss: 0.004317895244722339 | Val Loss: 0.004171656819784807 | Val Padded_cmAP : 0.6225584627257932













































































100%|██████████| 154/154 [02:38<00:00,  1.03s/it]










100%|██████████| 27/27 [00:27<00:00,  1.03s/it]
  0%|          | 0/154 [00:00<?, ?it/s]











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]












100%|██████████| 27/27 [00:27<00:00,  1.01s/it]
Epoch: 8 | Train Loss: 0.0034566340732158393 | Val Loss: 0.0032160721236356984 | Val Padded_cmAP : 0.7208866871152156










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]












100%|██████████| 27/27 [00:27<00:00,  1.03s/it]
  0%|          | 0/154 [00:00<?, ?it/s]












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]








100%|██████████| 27/27 [00:28<00:00,  1.07s/it]
Epoch: 10 | Train Loss: 0.002902957926770406 | Val Loss: 0.002874515325486384 | Val Padded_cmAP : 0.7540385633077908












































































100%|██████████| 154/154 [02:39<00:00,  1.04s/it]

  0%|          | 0/27 [00:03<?, ?it/s]
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3552, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/tmp/ipykernel_5359/1807090594.py", line 126, in <module>
    for inputs, sample_info in tqdm(val_dataloader):
  File "/opt/conda/lib/python3.7/site-packages/tqdm/std.py", line 1195, in __iter__
    for obj in iterable:
  File "/opt/conda/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 681, in __next__
    data = self._next_data()
  File "/opt/conda/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1359, in _next_data
    idx, data = self._get_data()
  File "/opt/conda/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1325, in _get_data
    success, data = self._try_get_data()
  File "/opt/conda/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 1163, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/opt/conda/lib/python3.7/multiprocessing/queues.py", line 104, in get
    if not self._poll(timeout):
  File "/opt/conda/lib/python3.7/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/opt/conda/lib/python3.7/multiprocessing/connection.py", line 414, in _poll
    r = wait([self], timeout)
  File "/opt/conda/lib/python3.7/multiprocessing/connection.py", line 921, in wait
    ready = selector.select(timeout)
  File "/opt/conda/lib/python3.7/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 2098, in showtraceback
    stb = value._render_traceback_()
AttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1101, in get_records
    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/ultratb.py", line 248, in wrapped
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/ultratb.py", line 281, in _fixed_getinnerframes
    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))
  File "/opt/conda/lib/python3.7/inspect.py", line 1502, in getinnerframes
    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)
  File "/opt/conda/lib/python3.7/inspect.py", line 1460, in getframeinfo
    filename = getsourcefile(frame) or getfile(frame)
  File "/opt/conda/lib/python3.7/inspect.py", line 696, in getsourcefile
    if getattr(getmodule(object, filename), '__loader__', None) is not None:
  File "/opt/conda/lib/python3.7/inspect.py", line 742, in getmodule
    os.path.realpath(f)] = module.__name__
  File "/opt/conda/lib/python3.7/posixpath.py", line 396, in realpath
    return abspath(path)
  File "/opt/conda/lib/python3.7/posixpath.py", line 385, in abspath
    return normpath(path)
  File "/opt/conda/lib/python3.7/posixpath.py", line 361, in normpath
    for comp in comps:
KeyboardInterrupt
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 152, in check_network_status
    status_response = self._interface.communicate_network_status()
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 138, in communicate_network_status
    resp = self._communicate_network_status(status)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 405, in _communicate_network_status
    resp = self._communicate(req, local=True)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 226, in _communicate
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 231, in _communicate_async
    raise Exception("The wandb backend process has shutdown")
