
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/fold-0_20230501_pretrained.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias', 'att_block.att.weight', 'att_block.att.bias', 'att_block.cla.weight', 'att_block.cla.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:12<00:00,  2.09it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]





 85%|████████▌ | 23/27 [00:11<00:01,  2.40it/s]
100%|██████████| 27/27 [00:12<00:00,  2.10it/s]

































































100%|██████████| 154/154 [02:10<00:00,  1.18it/s]





 89%|████████▉ | 24/27 [00:11<00:01,  2.40it/s]
100%|██████████| 27/27 [00:12<00:00,  2.12it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.18it/s]






 93%|█████████▎| 25/27 [00:11<00:00,  2.41it/s]
100%|██████████| 27/27 [00:12<00:00,  2.14it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]





100%|██████████| 27/27 [00:13<00:00,  2.03it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:10<00:00,  1.18it/s]





 85%|████████▌ | 23/27 [00:11<00:01,  2.39it/s]
100%|██████████| 27/27 [00:12<00:00,  2.12it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:13<00:00,  2.07it/s]
Epoch: 7 | Train Loss: 0.004205980812888834 | Val Loss: 0.005502849230887713 | Val Padded_cmAP : 0.47953986312485714
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:12<00:00,  2.10it/s]
Epoch: 8 | Train Loss: 0.004110477790659802 | Val Loss: 0.005396287008706067 | Val Padded_cmAP : 0.47942049736395165
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:12<00:00,  2.13it/s]
Epoch: 9 | Train Loss: 0.004044721465461053 | Val Loss: 0.005310716055747535 | Val Padded_cmAP : 0.47934958339940503
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:13<00:00,  2.07it/s]
Epoch: 10 | Train Loss: 0.004002395559211153 | Val Loss: 0.005285626915455969 | Val Padded_cmAP : 0.4792070127835024
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






 96%|█████████▋| 26/27 [00:12<00:00,  2.36it/s]
100%|██████████| 27/27 [00:12<00:00,  2.08it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






 89%|████████▉ | 24/27 [00:11<00:01,  2.40it/s]
100%|██████████| 27/27 [00:13<00:00,  2.06it/s]

































































100%|██████████| 154/154 [02:12<00:00,  1.16it/s]






100%|██████████| 27/27 [00:12<00:00,  2.88it/s]
100%|██████████| 27/27 [00:12<00:00,  2.10it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.34it/s]
100%|██████████| 27/27 [00:13<00:00,  2.04it/s]
































































100%|██████████| 154/154 [02:10<00:00,  1.18it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.32it/s]
100%|██████████| 27/27 [00:13<00:00,  2.06it/s]
































































100%|██████████| 154/154 [02:10<00:00,  1.18it/s]






 93%|█████████▎| 25/27 [00:11<00:00,  2.42it/s]
100%|██████████| 27/27 [00:12<00:00,  2.14it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:13<00:00,  2.04it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]





100%|██████████| 27/27 [00:12<00:00,  2.12it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:13<00:00,  2.06it/s]
Epoch: 19 | Train Loss: 0.0038048733258619905 | Val Loss: 0.005099715337295223 | Val Padded_cmAP : 0.4790918816343405
































































100%|██████████| 154/154 [02:10<00:00,  1.18it/s]





100%|██████████| 27/27 [00:12<00:00,  2.10it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:13<00:00,  2.05it/s]
Epoch: 21 | Train Loss: 0.0037809296816514876 | Val Loss: 0.005024624057114124 | Val Padded_cmAP : 0.47897895871479
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






 96%|█████████▋| 26/27 [00:12<00:00,  2.35it/s]
100%|██████████| 27/27 [00:13<00:00,  2.07it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:12<00:00,  2.15it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






 96%|█████████▋| 26/27 [00:12<00:00,  2.42it/s]
100%|██████████| 27/27 [00:12<00:00,  2.14it/s]
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:12<00:00,  2.15it/s]
Epoch: 25 | Train Loss: 0.0037498936667893228 | Val Loss: 0.0049211276281211115 | Val Padded_cmAP : 0.47921587210859296

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]





100%|██████████| 27/27 [00:12<00:00,  2.13it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]





100%|██████████| 27/27 [00:12<00:00,  2.13it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:13<00:00,  2.03it/s]
Epoch: 28 | Train Loss: 0.0037403740079517103 | Val Loss: 0.004921312995806888 | Val Padded_cmAP : 0.47909495418079096
































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]






100%|██████████| 27/27 [00:12<00:00,  2.12it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:11<00:00,  1.17it/s]





100%|██████████| 27/27 [00:13<00:00,  2.08it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 0.003736079582799371 | Val Loss: 0.004917445075180795 | Val Padded_cmAP : 0.4790887053489617
# Loading best model






100%|██████████| 27/27 [00:12<00:00,  2.12it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 3/3313 [00:00<14:29,  3.81it/s]
>>> FOLD 1 Padded_cmAP = 0.480

































































































wandb : 100%|██████████| 3313/3313 [03:15<00:00, 16.92it/s]