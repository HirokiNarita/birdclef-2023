
  0%|          | 0/307 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/multi_label/exp22_primary_label_2022_1st_like/fold-2.pth
<All keys matched successfully>
#########################
#### Training
#### Fold: 3 | Image Size: (128, 1001) | Model: tf_efficientnet_b1_ns | Batch Size: 64 | Scheduler: cos





















































































































































100%|██████████| 307/307 [05:26<00:00,  1.06s/it]










100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
Epoch: 1 | Train Loss: 2.1682259671462862 | Val Loss: 1.4685737601032964 | Val Padded_cmAP : 0.8965426493206485



























































































































































100%|██████████| 307/307 [05:24<00:00,  1.06s/it]










100%|██████████| 27/27 [00:22<00:00,  1.23it/s]
Epoch: 2 | Train Loss: 2.037975146638454 | Val Loss: 1.4361699852678511 | Val Padded_cmAP : 0.8977906898198397
























































































































































100%|██████████| 307/307 [05:17<00:00,  1.04s/it]










100%|██████████| 27/27 [00:22<00:00,  1.23it/s]
Epoch: 3 | Train Loss: 2.004795006121409 | Val Loss: 1.4275694798540186 | Val Padded_cmAP : 0.8984614729516767
























































































































































100%|██████████| 307/307 [05:24<00:00,  1.06s/it]










100%|██████████| 27/27 [00:21<00:00,  1.67it/s]
100%|██████████| 27/27 [00:21<00:00,  1.23it/s]



























































































































































100%|██████████| 307/307 [05:34<00:00,  1.09s/it]









100%|██████████| 27/27 [00:22<00:00,  1.23it/s]
  0%|          | 0/307 [00:00<?, ?it/s]

































































































































































100%|██████████| 307/307 [05:37<00:00,  1.10s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/307 [00:00<?, ?it/s]



















































































































































100%|██████████| 307/307 [05:13<00:00,  1.02s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/307 [00:00<?, ?it/s]






























































































































































100%|██████████| 307/307 [05:32<00:00,  1.08s/it]










100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
Epoch: 8 | Train Loss: 1.8579140614220684 | Val Loss: 1.4277646696126018 | Val Padded_cmAP : 0.899401483563489


























































































































































100%|██████████| 307/307 [05:35<00:00,  1.09s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/307 [00:00<?, ?it/s]


















































































































































100%|██████████| 307/307 [05:19<00:00,  1.04s/it]









100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/307 [00:00<?, ?it/s]



























































































































































100%|██████████| 307/307 [05:34<00:00,  1.09s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/307 [00:00<?, ?it/s]




























































































































































100%|██████████| 307/307 [05:33<00:00,  1.09s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/307 [00:00<?, ?it/s]




























































































































































100%|██████████| 307/307 [05:37<00:00,  1.10s/it]










100%|██████████| 27/27 [00:21<00:00,  1.23it/s]
  0%|          | 0/307 [00:00<?, ?it/s]





















































































































































100%|██████████| 307/307 [05:20<00:00,  1.04s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/307 [00:00<?, ?it/s]



























































































































































100%|██████████| 307/307 [05:36<00:00,  1.10s/it]










100%|██████████| 27/27 [00:22<00:00,  1.23it/s]
Epoch: 15 | Train Loss: 1.7773664102492193 | Val Loss: 1.4371617877924885 | Val Padded_cmAP : 0.8995453040151635






























































































































































100%|██████████| 307/307 [05:47<00:00,  1.13s/it]










 96%|█████████▋| 26/27 [00:23<00:00,  1.30it/s]
100%|██████████| 27/27 [00:23<00:00,  1.13it/s]












































































































































































100%|██████████| 307/307 [07:01<00:00,  1.37s/it]










100%|██████████| 27/27 [00:22<00:00,  1.21it/s]
Epoch: 17 | Train Loss: 1.7267661805261618 | Val Loss: 1.4496184024545882 | Val Padded_cmAP : 0.8990276204500649







































































































































































100%|██████████| 307/307 [06:15<00:00,  1.22s/it]









100%|██████████| 27/27 [00:22<00:00,  1.21it/s]
  0%|          | 0/307 [00:00<?, ?it/s]






























































































































































100%|██████████| 307/307 [05:52<00:00,  1.15s/it]









100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
  0%|          | 0/307 [00:00<?, ?it/s]





























































































































































100%|██████████| 307/307 [05:30<00:00,  1.08s/it]










100%|██████████| 27/27 [00:22<00:00,  1.22it/s]
Epoch: 20 | Train Loss: 1.722761493940695 | Val Loss: 1.4322756043186895 | Val Padded_cmAP : 0.8990907866531256
# Loading best model
# Infering OOF









100%|██████████| 27/27 [00:20<00:00,  1.30it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
>>> FOLD 3 Primary_Padded_cmAP = 0.901
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value




















wandb : 100%|██████████| 666/666 [00:40<00:00, 16.55it/s]