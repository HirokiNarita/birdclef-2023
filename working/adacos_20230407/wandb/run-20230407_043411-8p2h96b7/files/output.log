#########################
#### Training
#### Fold: 4 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,623 | Num Valid: 3,381



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 1 | Train Loss: 5.49429372378758 | Val Loss: 5.176142674905282 | Val Padded_cmAP : 0.4864818193401856


































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
Epoch: 2 | Train Loss: 4.8015030374774685 | Val Loss: 3.360196276947304 | Val Padded_cmAP : 0.6273557562913489



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  3.00it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
Epoch: 4 | Train Loss: 3.0419442885881893 | Val Loss: 1.8004782288162797 | Val Padded_cmAP : 0.7946919751104367



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  2.17it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 93%|█████████▎| 25/27 [00:17<00:00,  2.21it/s]
100%|██████████| 27/27 [00:17<00:00,  1.51it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 8 | Train Loss: 2.2429566615587704 | Val Loss: 1.424025148153305 | Val Padded_cmAP : 0.8422934229880262



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 9 | Train Loss: 2.1644212688718523 | Val Loss: 1.367639994179761 | Val Padded_cmAP : 0.8473432950265806



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Epoch: 10 | Train Loss: 2.0808039555301914 | Val Loss: 1.3151480555534363 | Val Padded_cmAP : 0.8564368666117256




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Epoch: 11 | Train Loss: 2.0087636500209958 | Val Loss: 1.331069693521217 | Val Padded_cmAP : 0.8551810595554139



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
Epoch: 12 | Train Loss: 1.970102746765335 | Val Loss: 1.3357676841594555 | Val Padded_cmAP : 0.8579183463756793



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 13 | Train Loss: 1.8988610126755454 | Val Loss: 1.3064758314026728 | Val Padded_cmAP : 0.8596791131508665



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 14 | Train Loss: 1.85001529733856 | Val Loss: 1.2724584054063868 | Val Padded_cmAP : 0.8608651271671475



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 15 | Train Loss: 1.8319339504489651 | Val Loss: 1.2277784557254225 | Val Padded_cmAP : 0.8687918875189303




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  2.15it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 93%|█████████▎| 25/27 [00:17<00:00,  2.00it/s]
100%|██████████| 27/27 [00:17<00:00,  1.52it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 93%|█████████▎| 25/27 [00:17<00:00,  2.13it/s]
100%|██████████| 27/27 [00:17<00:00,  1.51it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
Epoch: 19 | Train Loss: 1.6811685577615516 | Val Loss: 1.1774660806964945 | Val Padded_cmAP : 0.8711316902630261



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 20 | Train Loss: 1.6606473125420607 | Val Loss: 1.1251836982038286 | Val Padded_cmAP : 0.8760036842738436



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 21 | Train Loss: 1.6244808125805545 | Val Loss: 1.1119470971601981 | Val Padded_cmAP : 0.8796836025838407



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  3.01it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  2.87it/s]
100%|██████████| 27/27 [00:18<00:00,  1.49it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
Epoch: 24 | Train Loss: 1.5503787537673852 | Val Loss: 1.1005112550876759 | Val Padded_cmAP : 0.8802127948013365



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 25 | Train Loss: 1.5373467361772215 | Val Loss: 1.0931598599310275 | Val Padded_cmAP : 0.880389663354496




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 27 | Train Loss: 1.4846640461451048 | Val Loss: 1.0805242950165714 | Val Padded_cmAP : 0.8816093568880942



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  2.75it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 29 | Train Loss: 1.4513431524301503 | Val Loss: 1.065650204817454 | Val Padded_cmAP : 0.8837259748988394



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Epoch: 30 | Train Loss: 1.433282350564932 | Val Loss: 1.0567251576317682 | Val Padded_cmAP : 0.8843883016078519
# Loading best model
# Infering OOF



100%|██████████| 27/27 [00:09<00:00,  2.97it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 0/725 [00:00<?, ?it/s]
>>> FOLD 4 Padded_cmAP = 0.884



















wandb : 100%|██████████| 725/725 [00:36<00:00, 19.93it/s]