
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos



































































100%|██████████| 154/154 [02:21<00:00,  1.09it/s]








100%|██████████| 27/27 [00:19<00:00,  2.64it/s]
100%|██████████| 27/27 [00:20<00:00,  1.35it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:19<00:00,  2.02it/s]
100%|██████████| 27/27 [00:19<00:00,  1.35it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  2.63it/s]
100%|██████████| 27/27 [00:19<00:00,  1.37it/s]

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 4 | Train Loss: 2.4546031797087036 | Val Loss: 1.1126592048892268 | Val Padded_cmAP : 0.8856369986005513

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 5 | Train Loss: 2.3221299834065623 | Val Loss: 1.0425418703644365 | Val Padded_cmAP : 0.8948566734544041

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:19<00:00,  2.08it/s]
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








 93%|█████████▎| 25/27 [00:19<00:01,  1.90it/s]
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.05it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 10 | Train Loss: 1.9728313390310708 | Val Loss: 1.0078528037777654 | Val Padded_cmAP : 0.8957566751828301

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 11 | Train Loss: 1.9344484914432873 | Val Loss: 0.9528021315733591 | Val Padded_cmAP : 0.903814035897738

































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
Epoch: 12 | Train Loss: 1.8914021725778456 | Val Loss: 1.0176315131010834 | Val Padded_cmAP : 0.8963284384296931

































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 13 | Train Loss: 1.8775702196282227 | Val Loss: 0.9845019435441053 | Val Padded_cmAP : 0.8984920482927062


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.78it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 18 | Train Loss: 1.727952474897558 | Val Loss: 0.9084653280399464 | Val Padded_cmAP : 0.9081320864669361


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]







100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 25 | Train Loss: 1.5942770753587996 | Val Loss: 0.9786837266551124 | Val Padded_cmAP : 0.8977866646901741

































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
Epoch: 28 | Train Loss: 1.543648640056709 | Val Loss: 0.8692500933452889 | Val Padded_cmAP : 0.9102072840510077

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
Epoch: 30 | Train Loss: 1.522937860581782 | Val Loss: 0.8951230645179749 | Val Padded_cmAP : 0.9073165045620489
# Loading best model
# Infering OOF






100%|██████████| 27/27 [00:13<00:00,  1.94it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   1%|          | 7/643 [00:00<01:02, 10.26it/s]
>>> FOLD 1 Padded_cmAP = 0.910
















wandb : 100%|██████████| 643/643 [00:32<00:00, 19.69it/s]