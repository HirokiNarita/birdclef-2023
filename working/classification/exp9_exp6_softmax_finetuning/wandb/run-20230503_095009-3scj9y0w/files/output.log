load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 4 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,623 | Num Valid: 3,381









































































100%|██████████| 154/154 [02:30<00:00,  1.02it/s]









100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 1 | Train Loss: 5.393907776126614 | Val Loss: 4.581222754937631 | Val Padded_cmAP : 0.544217350537558





































































100%|██████████| 154/154 [02:23<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 2 | Train Loss: 3.8569752829415456 | Val Loss: 1.7399755937081796 | Val Padded_cmAP : 0.8154951420860111







































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  1.89it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]







































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 4 | Train Loss: 2.4569829067626556 | Val Loss: 1.2172774032310203 | Val Padded_cmAP : 0.8718502543806234






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]







100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 6 | Train Loss: 2.2281256681912907 | Val Loss: 1.1915218013304252 | Val Padded_cmAP : 0.8753348810342244





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 7 | Train Loss: 2.145307030770686 | Val Loss: 1.0977498326036665 | Val Padded_cmAP : 0.88606369863215






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  1.90it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  2.46it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 10 | Train Loss: 1.9712340506640347 | Val Loss: 1.1006468402014837 | Val Padded_cmAP : 0.8852152568441305







































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]









100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 11 | Train Loss: 1.9432722461688055 | Val Loss: 1.168702056010564 | Val Padded_cmAP : 0.8753673515455093






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 12 | Train Loss: 1.8943675222334924 | Val Loss: 1.049571387193821 | Val Padded_cmAP : 0.8892458324368732






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 15 | Train Loss: 1.8025265219923738 | Val Loss: 1.1101688455652308 | Val Padded_cmAP : 0.8839825678175959






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 23 | Train Loss: 1.6275344119443522 | Val Loss: 0.9801316835262157 | Val Padded_cmAP : 0.8957021376394498






































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







 89%|████████▉ | 24/27 [00:16<00:01,  1.91it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.98it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  1.95it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.08it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 28 | Train Loss: 1.5365838091094772 | Val Loss: 0.9362661032765 | Val Padded_cmAP : 0.8992305389735878






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  1.87it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]






































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 1.5163682010266688 | Val Loss: 0.9082957870430417 | Val Padded_cmAP : 0.9033348635055052
# Loading best model






100%|██████████| 27/27 [00:13<00:00,  1.93it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
>>> FOLD 4 Padded_cmAP = 0.903
# WandB
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value


















wandb : 100%|██████████| 642/642 [00:35<00:00, 17.92it/s]