load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 2 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,629 | Num Valid: 3,382



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  1.87it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.89it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.17it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.07it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.89it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.75it/s]
100%|██████████| 27/27 [00:18<00:00,  1.48it/s]

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.03it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.13it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 13 | Train Loss: 1.8562195068830019 | Val Loss: 0.9905875987476773 | Val Padded_cmAP : 0.9034020968179949


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 14 | Train Loss: 1.8328570173932361 | Val Loss: 1.0076192440810028 | Val Padded_cmAP : 0.8986930078509381


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]









100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 16 | Train Loss: 1.7953163516985906 | Val Loss: 0.9908617712833263 | Val Padded_cmAP : 0.8999694206017494


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.90it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 20 | Train Loss: 1.6768173799886332 | Val Loss: 1.0506990044205278 | Val Padded_cmAP : 0.8942299665251927

































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]







100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 25 | Train Loss: 1.5857913168993862 | Val Loss: 0.9238512427718552 | Val Padded_cmAP : 0.9055669711054605






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]









100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 29 | Train Loss: 1.5371159973082604 | Val Loss: 0.8902092200738413 | Val Padded_cmAP : 0.9105287478406475


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 1.5203500390052795 | Val Loss: 0.9126554109432079 | Val Padded_cmAP : 0.9077819989108271
# Loading best model






100%|██████████| 27/27 [00:12<00:00,  2.17it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   3%|▎         | 20/674 [00:00<00:28, 22.63it/s]
>>> FOLD 2 Padded_cmAP = 0.911


















wandb : 100%|██████████| 674/674 [00:36<00:00, 18.60it/s]