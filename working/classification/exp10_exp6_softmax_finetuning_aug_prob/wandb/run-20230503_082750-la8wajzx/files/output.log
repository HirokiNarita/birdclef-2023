
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 3 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos


































































100%|██████████| 154/154 [02:16<00:00,  1.13it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.06it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.94it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 4 | Train Loss: 2.46289866001575 | Val Loss: 1.1985939608679876 | Val Padded_cmAP : 0.8783084544248039


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  1.93it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  1.80it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.13it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 9 | Train Loss: 2.0390512610410716 | Val Loss: 1.084991737648293 | Val Padded_cmAP : 0.8890808635990128


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  1.89it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:17<00:00,  2.51it/s]
100%|██████████| 27/27 [00:17<00:00,  1.52it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







 89%|████████▉ | 24/27 [00:16<00:01,  1.87it/s]
100%|██████████| 27/27 [00:18<00:00,  1.49it/s]

































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.03it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 15 | Train Loss: 1.81712054122578 | Val Loss: 1.0402068197727203 | Val Padded_cmAP : 0.8956302976057032


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.58it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]












































































100%|██████████| 154/154 [02:36<00:00,  1.01s/it]








100%|██████████| 27/27 [00:19<00:00,  2.51it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]










































































100%|██████████| 154/154 [02:33<00:00,  1.00it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 19 | Train Loss: 1.7133269944748322 | Val Loss: 1.042413765081653 | Val Padded_cmAP : 0.8933501665252908












































































100%|██████████| 154/154 [02:37<00:00,  1.02s/it]








 93%|█████████▎| 25/27 [00:18<00:01,  1.97it/s]
100%|██████████| 27/27 [00:19<00:00,  1.38it/s]











































































100%|██████████| 154/154 [02:34<00:00,  1.00s/it]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]












































































100%|██████████| 154/154 [02:36<00:00,  1.02s/it]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 22 | Train Loss: 1.6527406495886963 | Val Loss: 0.9772794671632625 | Val Padded_cmAP : 0.901042574869849











































































100%|██████████| 154/154 [02:35<00:00,  1.01s/it]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]













































































100%|██████████| 154/154 [02:39<00:00,  1.04s/it]









100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 24 | Train Loss: 1.6122826012698086 | Val Loss: 0.9489181759180846 | Val Padded_cmAP : 0.9055526478051179






































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]







100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 28 | Train Loss: 1.5471044972345427 | Val Loss: 0.9494166628078178 | Val Padded_cmAP : 0.9042016270724925






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 30 | Train Loss: 1.537140232402009 | Val Loss: 0.9213690250008194 | Val Padded_cmAP : 0.9070426610906787
# Loading best model
# Infering OOF






100%|██████████| 27/27 [00:13<00:00,  1.93it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   2%|▏         | 11/654 [00:00<00:30, 20.79it/s]
>>> FOLD 3 Padded_cmAP = 0.907




















wandb : 100%|██████████| 654/654 [00:39<00:00, 16.41it/s]