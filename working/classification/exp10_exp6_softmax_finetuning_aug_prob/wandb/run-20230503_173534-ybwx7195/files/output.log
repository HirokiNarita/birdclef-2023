load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 5 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,624 | Num Valid: 3,380


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]







 89%|████████▉ | 24/27 [00:16<00:01,  1.96it/s]
100%|██████████| 27/27 [00:18<00:00,  1.48it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.08it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.01it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 5 | Train Loss: 1.8750691684809597 | Val Loss: 1.069202035665512 | Val Padded_cmAP : 0.8864837964282682

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 6 | Train Loss: 1.7741856853683273 | Val Loss: 1.0940307632640556 | Val Padded_cmAP : 0.8846410550042481

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 8 | Train Loss: 1.608637108431234 | Val Loss: 1.0756631631542135 | Val Padded_cmAP : 0.8922118295506086

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  1.87it/s]
100%|██████████| 27/27 [00:19<00:00,  1.42it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  2.62it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  2.62it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 13 | Train Loss: 1.401445979421789 | Val Loss: 0.9801275178238198 | Val Padded_cmAP : 0.8967384590244178

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 16 | Train Loss: 1.319770895815515 | Val Loss: 0.9523417441933243 | Val Padded_cmAP : 0.9018325990713183

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 18 | Train Loss: 1.272958969915068 | Val Loss: 0.9266631117573491 | Val Padded_cmAP : 0.9061397008522445

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]









100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 21 | Train Loss: 1.2037824574229006 | Val Loss: 0.9342562710797345 | Val Padded_cmAP : 0.90678411700993


































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:19<00:00,  2.58it/s]
Epoch: 30 | Train Loss: 1.091177308714235 | Val Loss: 0.8723917222685285 | Val Padded_cmAP : 0.912193265283954
# Loading best model
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.34it/s]
>>> FOLD 5 Padded_cmAP = 0.912
100%|██████████| 27/27 [00:13<00:00,  2.01it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value















wandb : 100%|██████████| 605/605 [00:30<00:00, 19.70it/s]