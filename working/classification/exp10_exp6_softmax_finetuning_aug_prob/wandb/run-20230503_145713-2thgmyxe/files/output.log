
load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 3 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,629 | Num Valid: 3,381









































































100%|██████████| 154/154 [02:32<00:00,  1.01it/s]









100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 2 | Train Loss: 3.646188763829021 | Val Loss: 1.7679300595212866 | Val Padded_cmAP : 0.819262942736624






































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 3 | Train Loss: 2.410528915269034 | Val Loss: 1.2926066871042605 | Val Padded_cmAP : 0.8647486040099143






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







 93%|█████████▎| 25/27 [00:17<00:01,  1.69it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]







































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 5 | Train Loss: 1.8621099142285136 | Val Loss: 1.1510790873456884 | Val Padded_cmAP : 0.8828721303300068





































































100%|██████████| 154/154 [02:21<00:00,  1.09it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.89it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 7 | Train Loss: 1.6806630786363181 | Val Loss: 1.140367415216234 | Val Padded_cmAP : 0.8830934845088869





































































100%|██████████| 154/154 [02:23<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]







































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 9 | Train Loss: 1.558454425303967 | Val Loss: 1.094344167245759 | Val Padded_cmAP : 0.8902634149156021




































































100%|██████████| 154/154 [02:20<00:00,  1.09it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 10 | Train Loss: 1.5183263188832765 | Val Loss: 1.059675540637087 | Val Padded_cmAP : 0.8949206293613885

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  2.59it/s]
100%|██████████| 27/27 [00:18<00:00,  1.49it/s]


































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]









100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 18 | Train Loss: 1.2606286836134923 | Val Loss: 1.029788515082112 | Val Padded_cmAP : 0.8994088065260016

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 21 | Train Loss: 1.2244836494520113 | Val Loss: 0.981672693181921 | Val Padded_cmAP : 0.9046400394168067

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.13it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  2.02it/s]
100%|██████████| 27/27 [00:18<00:00,  1.48it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








 93%|█████████▎| 25/27 [00:17<00:01,  1.92it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 25 | Train Loss: 1.1452071682199256 | Val Loss: 0.9651337541915752 | Val Padded_cmAP : 0.9091552879428914

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 26 | Train Loss: 1.1360381292058277 | Val Loss: 0.9464704245328903 | Val Padded_cmAP : 0.909179490668337

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 27 | Train Loss: 1.1091189639908927 | Val Loss: 0.922065646008209 | Val Padded_cmAP : 0.9112599793060697

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 28 | Train Loss: 1.107056836416195 | Val Loss: 0.9340361406405767 | Val Padded_cmAP : 0.9113790710029418

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 29 | Train Loss: 1.0970791713757948 | Val Loss: 0.9129541141015513 | Val Padded_cmAP : 0.9113817232561294


































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  1.72it/s]
Epoch: 30 | Train Loss: 1.1032054869385508 | Val Loss: 0.9204484743100626 | Val Padded_cmAP : 0.9107611412786067
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/27 [00:00<?, ?it/s]






 93%|█████████▎| 25/27 [00:12<00:00,  2.35it/s]
>>> FOLD 3 Padded_cmAP = 0.911
100%|██████████| 27/27 [00:13<00:00,  2.05it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
















wandb : 100%|██████████| 636/636 [00:32<00:00, 19.55it/s]