
  0%|          | 0/154 [00:00<?, ?it/s]
load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos




































































100%|██████████| 154/154 [02:27<00:00,  1.04it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 1 | Train Loss: 5.372656190550172 | Val Loss: 4.7160430131135165 | Val Padded_cmAP : 0.5398011743843087





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:20<00:00,  1.09it/s]








 93%|█████████▎| 25/27 [00:19<00:00,  2.14it/s]
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]




































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 4 | Train Loss: 2.0244631202189955 | Val Loss: 1.085677053089495 | Val Padded_cmAP : 0.8874352428916985





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  2.63it/s]
100%|██████████| 27/27 [00:19<00:00,  1.37it/s]





































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
Epoch: 6 | Train Loss: 1.7811195649109877 | Val Loss: 1.1092167496681213 | Val Padded_cmAP : 0.8876035312337938





































































100%|██████████| 154/154 [02:23<00:00,  1.08it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
Epoch: 7 | Train Loss: 1.700669867651803 | Val Loss: 1.042732564387498 | Val Padded_cmAP : 0.8962456477855205





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]









100%|██████████| 27/27 [00:20<00:00,  1.31it/s]
Epoch: 8 | Train Loss: 1.5957266115523003 | Val Loss: 1.0091243844341349 | Val Padded_cmAP : 0.8973263684088275








































































100%|██████████| 154/154 [02:28<00:00,  1.04it/s]








100%|██████████| 27/27 [00:20<00:00,  1.30it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








 96%|█████████▋| 26/27 [00:19<00:00,  2.16it/s]
100%|██████████| 27/27 [00:20<00:00,  1.34it/s]





































































100%|██████████| 154/154 [02:21<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 11 | Train Loss: 1.4451116625364724 | Val Loss: 0.9547693734919583 | Val Padded_cmAP : 0.9042921505653013




































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
Epoch: 12 | Train Loss: 1.4104659704418925 | Val Loss: 0.9960206294501269 | Val Padded_cmAP : 0.9017181113428858






































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 13 | Train Loss: 1.380333939155975 | Val Loss: 0.9790208207236396 | Val Padded_cmAP : 0.9058715851581907





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
Epoch: 14 | Train Loss: 1.3675947398334354 | Val Loss: 0.9476187814165045 | Val Padded_cmAP : 0.9066119567390821






































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]






































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








 96%|█████████▋| 26/27 [00:19<00:00,  1.98it/s]
100%|██████████| 27/27 [00:19<00:00,  1.38it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]







100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:25<00:00,  1.06it/s]








100%|██████████| 27/27 [00:20<00:00,  1.32it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:24<00:00,  1.06it/s]







100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:20<00:00,  1.09it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]







100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:24<00:00,  1.07it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.68it/s]
100%|██████████| 27/27 [00:19<00:00,  1.37it/s]





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 26 | Train Loss: 1.0935507877306505 | Val Loss: 0.8422473707684764 | Val Padded_cmAP : 0.9172690486093469







































































100%|██████████| 154/154 [02:26<00:00,  1.05it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 27 | Train Loss: 1.1067464831587557 | Val Loss: 0.8244670850259287 | Val Padded_cmAP : 0.9174176734615392





































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 28 | Train Loss: 1.111597245389765 | Val Loss: 0.8255049895357203 | Val Padded_cmAP : 0.9195009861395236





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








100%|██████████| 27/27 [00:19<00:00,  2.60it/s]
100%|██████████| 27/27 [00:19<00:00,  1.37it/s]





































































100%|██████████| 154/154 [02:22<00:00,  1.08it/s]








 89%|████████▉ | 24/27 [00:18<00:01,  1.95it/s]
Epoch: 30 | Train Loss: 1.0822067105924928 | Val Loss: 0.8316455488955533 | Val Padded_cmAP : 0.9190687480392772
# Loading best model
100%|██████████| 27/27 [00:20<00:00,  1.34it/s]






 89%|████████▉ | 24/27 [00:14<00:01,  2.27it/s]
>>> FOLD 1 Padded_cmAP = 0.920
100%|██████████| 27/27 [00:15<00:00,  1.76it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value

















wandb : 100%|██████████| 577/577 [00:33<00:00, 17.40it/s]