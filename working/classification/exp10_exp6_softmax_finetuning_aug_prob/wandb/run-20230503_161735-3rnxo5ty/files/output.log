load pre-trained model :  /kaggle/working/pre-training/exp2_pre_softmax_horizontalflip/fold-0_20230503_21epoch.pth
_IncompatibleKeys(missing_keys=['model.classifier.weight', 'model.classifier.bias'], unexpected_keys=['to_melspec_fn.spectrogram.window', 'to_melspec_fn.mel_scale.fb'])
#########################
#### Training
#### Fold: 4 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,623 | Num Valid: 3,381


































































100%|██████████| 154/154 [02:15<00:00,  1.14it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 1 | Train Loss: 5.372071541749038 | Val Loss: 4.677547869858919 | Val Padded_cmAP : 0.5390906650916754


































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








 89%|████████▉ | 24/27 [00:17<00:01,  1.87it/s]
100%|██████████| 27/27 [00:18<00:00,  1.47it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
Epoch: 4 | Train Loss: 2.006038753243236 | Val Loss: 1.1577296179753762 | Val Padded_cmAP : 0.8794271319615778

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.09it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 8 | Train Loss: 1.5869342986639443 | Val Loss: 1.052125997013516 | Val Padded_cmAP : 0.8912150513417592

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 9 | Train Loss: 1.5523200081540394 | Val Loss: 1.045730737624345 | Val Padded_cmAP : 0.8931475637372556
































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 10 | Train Loss: 1.496313229783789 | Val Loss: 1.0618770856548239 | Val Padded_cmAP : 0.8935359775655153
































































100%|██████████| 154/154 [02:13<00:00,  1.16it/s]








100%|██████████| 27/27 [00:18<00:00,  2.39it/s]
100%|██████████| 27/27 [00:18<00:00,  1.48it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
Epoch: 13 | Train Loss: 1.376208025913734 | Val Loss: 1.0793345443628453 | Val Padded_cmAP : 0.8956256110167011
































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 14 | Train Loss: 1.3726512886487043 | Val Loss: 1.0209419865299154 | Val Padded_cmAP : 0.8966348971193407

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]









100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 15 | Train Loss: 1.3405413689551415 | Val Loss: 1.0299004272178367 | Val Padded_cmAP : 0.8979141180877819

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
Epoch: 19 | Train Loss: 1.2474548731531416 | Val Loss: 0.9878356318782877 | Val Padded_cmAP : 0.9029259446951503

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.48it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]







100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]









100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
Epoch: 26 | Train Loss: 1.1248668478680897 | Val Loss: 0.9161809782187144 | Val Padded_cmAP : 0.9099082485457268

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]


































































100%|██████████| 154/154 [02:14<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.46it/s]
  0%|          | 0/154 [00:00<?, ?it/s]

































































100%|██████████| 154/154 [02:13<00:00,  1.15it/s]








100%|██████████| 27/27 [00:18<00:00,  1.47it/s]
  0%|          | 0/27 [00:00<?, ?it/s]
Epoch: 30 | Train Loss: 1.0737258532604614 | Val Loss: 0.9079730952227557 | Val Padded_cmAP : 0.9104689971962632
# Loading best model






100%|██████████| 27/27 [00:13<00:00,  2.03it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 2/599 [00:00<00:39, 14.98it/s]
>>> FOLD 4 Padded_cmAP = 0.910















wandb : 100%|██████████| 599/599 [00:30<00:00, 19.79it/s]