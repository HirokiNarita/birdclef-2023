#########################
#### Training
#### Fold: 5 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,624 | Num Valid: 3,380



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]







 89%|████████▉ | 24/27 [00:16<00:01,  2.16it/s]
100%|██████████| 27/27 [00:17<00:00,  1.51it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.11it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
Epoch: 2 | Train Loss: 8.51383442383308 | Val Loss: 5.3737585456283 | Val Padded_cmAP : 0.5975764916991271





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 3 | Train Loss: 7.290193412211035 | Val Loss: 5.17286600889983 | Val Padded_cmAP : 0.7251892553300398





































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.57it/s]
Epoch: 4 | Train Loss: 6.2567351762350505 | Val Loss: 5.0617563812821 | Val Padded_cmAP : 0.7705932522111297





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Epoch: 5 | Train Loss: 5.515856009025078 | Val Loss: 5.006311487268518 | Val Padded_cmAP : 0.8008952565559462





































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 6 | Train Loss: 4.997385223190506 | Val Loss: 4.9764092056839555 | Val Padded_cmAP : 0.8152578284008745




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
Epoch: 7 | Train Loss: 4.569042134594608 | Val Loss: 4.940138269353796 | Val Padded_cmAP : 0.8355566851256228





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
Epoch: 8 | Train Loss: 4.262032926856698 | Val Loss: 4.919280793931749 | Val Padded_cmAP : 0.8429901497592237




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
Epoch: 9 | Train Loss: 4.007830079499778 | Val Loss: 4.920446855050546 | Val Padded_cmAP : 0.8454701792865865





































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
Epoch: 10 | Train Loss: 3.8375524019266103 | Val Loss: 4.9079473283555775 | Val Padded_cmAP : 0.8542236344596654





































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.55it/s]
Epoch: 12 | Train Loss: 3.517343748699535 | Val Loss: 4.886670677750199 | Val Padded_cmAP : 0.8590228414559533




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
Epoch: 13 | Train Loss: 3.395132247503702 | Val Loss: 4.8803586606626155 | Val Padded_cmAP : 0.8652234960599002




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.55it/s]
Epoch: 14 | Train Loss: 3.290217277291533 | Val Loss: 4.867943622447826 | Val Padded_cmAP : 0.8685541617066257




































































100%|██████████| 154/154 [02:19<00:00,  1.11it/s]







100%|██████████| 27/27 [00:17<00:00,  1.55it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.55it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]







100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]







100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
  0%|          | 0/154 [00:00<?, ?it/s]





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.55it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]







 81%|████████▏ | 22/27 [00:16<00:03,  1.48it/s]
100%|██████████| 27/27 [00:17<00:00,  1.53it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]







 93%|█████████▎| 25/27 [00:16<00:00,  2.16it/s]
100%|██████████| 27/27 [00:17<00:00,  1.55it/s]





































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








 93%|█████████▎| 25/27 [00:17<00:00,  2.09it/s]
100%|██████████| 27/27 [00:18<00:00,  1.49it/s]




































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]







 81%|████████▏ | 22/27 [00:16<00:03,  1.66it/s]
100%|██████████| 27/27 [00:17<00:00,  1.52it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]







 85%|████████▌ | 23/27 [00:16<00:02,  1.55it/s]
100%|██████████| 27/27 [00:17<00:00,  1.53it/s]




































































100%|██████████| 154/154 [02:19<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  3.00it/s]
100%|██████████| 27/27 [00:17<00:00,  1.55it/s]




































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]







 89%|████████▉ | 24/27 [00:16<00:01,  2.19it/s]
100%|██████████| 27/27 [00:17<00:00,  1.51it/s]




































































100%|██████████| 154/154 [02:20<00:00,  1.10it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
Epoch: 30 | Train Loss: 2.418612519641975 | Val Loss: 4.809920734829372 | Val Padded_cmAP : 0.8916320647151066
# Loading best model
# Infering OOF



100%|██████████| 27/27 [00:08<00:00,  3.06it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
wandb :   0%|          | 0/703 [00:00<?, ?it/s]
>>> FOLD 5 Padded_cmAP = 0.892


















wandb : 100%|██████████| 703/703 [00:34<00:00, 20.11it/s]