#########################
#### Training
#### Fold: 2 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,629 | Num Valid: 3,382



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  2.79it/s]
100%|██████████| 27/27 [00:18<00:00,  1.46it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Epoch: 2 | Train Loss: 4.843294245856149 | Val Loss: 3.448562648561266 | Val Padded_cmAP : 0.6099153566440043



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 3 | Train Loss: 3.709143562750383 | Val Loss: 2.240721927748786 | Val Padded_cmAP : 0.7449109248951155



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
Epoch: 4 | Train Loss: 3.062720657943131 | Val Loss: 1.878247031459102 | Val Padded_cmAP : 0.792680568162238



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 5 | Train Loss: 2.754868381983274 | Val Loss: 1.7049902037337974 | Val Padded_cmAP : 0.8156271589483368



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
Epoch: 6 | Train Loss: 2.552268124245978 | Val Loss: 1.6128515270021226 | Val Padded_cmAP : 0.8308908194216631



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 7 | Train Loss: 2.3827705073666263 | Val Loss: 1.4601968041172735 | Val Padded_cmAP : 0.8420653752238628



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 8 | Train Loss: 2.2471717673462708 | Val Loss: 1.4124265909194946 | Val Padded_cmAP : 0.8453474506986284




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  3.01it/s]
100%|██████████| 27/27 [00:18<00:00,  1.49it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








 96%|█████████▋| 26/27 [00:17<00:00,  2.08it/s]
100%|██████████| 27/27 [00:17<00:00,  1.53it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
Epoch: 11 | Train Loss: 2.0181846997954627 | Val Loss: 1.3208833634853363 | Val Padded_cmAP : 0.8624923350185191



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 93%|█████████▎| 25/27 [00:17<00:01,  1.98it/s]
100%|██████████| 27/27 [00:17<00:00,  1.51it/s]




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
Epoch: 14 | Train Loss: 1.8489555244321947 | Val Loss: 1.204279104868571 | Val Padded_cmAP : 0.8732540717186357



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  2.98it/s]
100%|██████████| 27/27 [00:17<00:00,  1.53it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
Epoch: 17 | Train Loss: 1.7352782789762917 | Val Loss: 1.1324097701796778 | Val Padded_cmAP : 0.8808117496333818




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
Epoch: 19 | Train Loss: 1.6756026953845828 | Val Loss: 1.1344534909283672 | Val Padded_cmAP : 0.8824450223797823



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.49it/s]
Epoch: 21 | Train Loss: 1.6110983421276142 | Val Loss: 1.1052801101296037 | Val Padded_cmAP : 0.8850185414455254



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:17<00:00,  1.54it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.52it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:18<00:00,  1.50it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]









100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 25 | Train Loss: 1.5140563876597912 | Val Loss: 1.0656755566596985 | Val Padded_cmAP : 0.8882322251570228



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:17<00:00,  1.53it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







100%|██████████| 27/27 [00:17<00:00,  1.51it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]








100%|██████████| 27/27 [00:17<00:00,  1.50it/s]
Epoch: 28 | Train Loss: 1.4710452757872545 | Val Loss: 1.0497558337670785 | Val Padded_cmAP : 0.8911764179399991



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 85%|████████▌ | 23/27 [00:16<00:02,  1.64it/s]
100%|██████████| 27/27 [00:17<00:00,  1.52it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]







 89%|████████▉ | 24/27 [00:16<00:01,  2.19it/s]
Epoch: 30 | Train Loss: 1.4368678733899996 | Val Loss: 1.0450403061177995 | Val Padded_cmAP : 0.8903257810489857
# Loading best model
100%|██████████| 27/27 [00:18<00:00,  1.49it/s]




 93%|█████████▎| 25/27 [00:08<00:00,  3.56it/s]
>>> FOLD 2 Padded_cmAP = 0.891
100%|██████████| 27/27 [00:09<00:00,  2.95it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value




















wandb : 100%|██████████| 761/761 [00:39<00:00, 19.24it/s]