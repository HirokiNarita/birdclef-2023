
Downloading: "https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b1_ns-99dd0c41.pth" to /root/.cache/torch/hub/checkpoints/tf_efficientnet_b1_ns-99dd0c41.pth
#########################
#### Training
#### Fold: 1 | Image Size: (128, 256) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381























































100%|██████████| 154/154 [01:59<00:00,  1.29it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 1 | Train Loss: 0.3092085617509755 | Val Loss: 0.06029397649345575 | Val Padded_cmAP : 0.47991883834309695
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.74it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







 93%|█████████▎| 25/27 [00:18<00:00,  2.01it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  2.26it/s]
100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 6 | Train Loss: 0.00039449962844025923 | Val Loss: 0.00030979621913973933 | Val Padded_cmAP : 0.4797001469361269

























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  2.25it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.34it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  2.18it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 9 | Train Loss: 0.00011871166606834339 | Val Loss: 0.00010311806329776084 | Val Padded_cmAP : 0.4795005192024727
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.34it/s]
100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  2.25it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 12 | Train Loss: 4.989502776407353e-05 | Val Loss: 4.78399834483517e-05 | Val Padded_cmAP : 0.47940135554328206

























































100%|██████████| 154/154 [01:56<00:00,  1.33it/s]







 89%|████████▉ | 24/27 [00:17<00:01,  2.38it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:56<00:00,  1.33it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.90it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 17 | Train Loss: 2.0231601517373854e-05 | Val Loss: 1.887323459312837e-05 | Val Padded_cmAP : 0.4797831524635026























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.48it/s]
100%|██████████| 27/27 [00:18<00:00,  1.44it/s]























































100%|██████████| 154/154 [01:55<00:00,  1.34it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.86it/s]
100%|██████████| 27/27 [00:18<00:00,  1.45it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.34it/s]







100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 22 | Train Loss: 1.1375279002520559e-05 | Val Loss: 1.1157871119427943e-05 | Val Padded_cmAP : 0.47946004917756524
























































100%|██████████| 154/154 [01:55<00:00,  1.34it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 23 | Train Loss: 1.0388539569201432e-05 | Val Loss: 1.0469420751043665e-05 | Val Padded_cmAP : 0.4795942247079942
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:18<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.34it/s]







100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]
























































100%|██████████| 154/154 [01:55<00:00,  1.33it/s]








100%|██████████| 27/27 [00:18<00:00,  1.44it/s]
Epoch: 30 | Train Loss: 6.579291322567143e-06 | Val Loss: 6.507170736666821e-06 | Val Padded_cmAP : 0.47953043869291406
# Loading best model
# Infering OOF



 81%|████████▏ | 22/27 [00:07<00:01,  4.23it/s]
>>> FOLD 1 Padded_cmAP = 0.480
100%|██████████| 27/27 [00:08<00:00,  3.07it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
























































































wandb :  87%|████████▋ | 2930/3375 [02:58<00:30, 14.44it/s]
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 3552, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "/tmp/ipykernel_207/1108362053.py", line 192, in <module>
    log_wandb(valid_df)
  File "/tmp/ipykernel_207/2619424295.py", line 29, in log_wandb
    audio, sr = librosa.load(filepath, sr=None)
  File "/opt/conda/lib/python3.7/site-packages/librosa/util/decorators.py", line 88, in inner_f
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/librosa/core/audio.py", line 164, in load
    y, sr_native = __soundfile_load(path, offset, duration, dtype)
  File "/opt/conda/lib/python3.7/site-packages/librosa/core/audio.py", line 208, in __soundfile_load
    y = sf_desc.read(frames=frame_duration, dtype=dtype, always_2d=False).T
  File "/opt/conda/lib/python3.7/site-packages/soundfile.py", line 892, in read
    frames = self._array_io('read', out, frames)
  File "/opt/conda/lib/python3.7/site-packages/soundfile.py", line 1341, in _array_io
    return self._cdata_io(action, cdata, ctype, frames)
  File "/opt/conda/lib/python3.7/site-packages/soundfile.py", line 1350, in _cdata_io
    frames = func(self._file, data, frames)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/interactiveshell.py", line 2098, in showtraceback
    stb = value._render_traceback_()
AttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/ultratb.py", line 1101, in get_records
    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/ultratb.py", line 248, in wrapped
    return f(*args, **kwargs)
  File "/opt/conda/lib/python3.7/site-packages/IPython/core/ultratb.py", line 281, in _fixed_getinnerframes
    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))
  File "/opt/conda/lib/python3.7/inspect.py", line 1502, in getinnerframes
    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)
  File "/opt/conda/lib/python3.7/inspect.py", line 1460, in getframeinfo
    filename = getsourcefile(frame) or getfile(frame)
  File "/opt/conda/lib/python3.7/inspect.py", line 696, in getsourcefile
    if getattr(getmodule(object, filename), '__loader__', None) is not None:
  File "/opt/conda/lib/python3.7/inspect.py", line 739, in getmodule
    f = getabsfile(module)
  File "/opt/conda/lib/python3.7/inspect.py", line 708, in getabsfile
    _filename = getsourcefile(object) or getfile(object)
  File "/opt/conda/lib/python3.7/inspect.py", line 693, in getsourcefile
    if os.path.exists(filename):
  File "/opt/conda/lib/python3.7/genericpath.py", line 19, in exists
    os.stat(path)

wandb :  87%|████████▋ | 2949/3375 [02:59<00:25, 16.41it/s]
Process wandb_internal:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/opt/conda/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/internal/internal.py", line 160, in wandb_internal
    thread.join()
  File "/opt/conda/lib/python3.7/threading.py", line 1044, in join
    self._wait_for_tstate_lock()
  File "/opt/conda/lib/python3.7/threading.py", line 1060, in _wait_for_tstate_lock
    elif lock.acquire(block, timeout):
KeyboardInterrupt
Traceback (most recent call last):
  File "<string>", line 1, in <module>
  File "/opt/conda/lib/python3.7/multiprocessing/spawn.py", line 105, in spawn_main
    exitcode = _main(fd)
  File "/opt/conda/lib/python3.7/multiprocessing/spawn.py", line 118, in _main
    return self._bootstrap()
  File "/opt/conda/lib/python3.7/multiprocessing/process.py", line 315, in _bootstrap
    threading._shutdown()
  File "/opt/conda/lib/python3.7/threading.py", line 1307, in _shutdown
    lock.acquire()
KeyboardInterrupt
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 152, in check_network_status
    status_response = self._interface.communicate_network_status()
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 138, in communicate_network_status
    resp = self._communicate_network_status(status)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 405, in _communicate_network_status
    resp = self._communicate(req, local=True)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 226, in _communicate
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 231, in _communicate_async
    raise Exception("The wandb backend process has shutdown")
Exception: The wandb backend process has shutdown
Exception in thread ChkStopThr:
Traceback (most recent call last):
  File "/opt/conda/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/opt/conda/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/wandb_run.py", line 170, in check_status
    status_response = self._interface.communicate_stop_status()
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface.py", line 127, in communicate_stop_status
    resp = self._communicate_stop_status(status)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 395, in _communicate_stop_status
    resp = self._communicate(req, local=True)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 226, in _communicate
    return self._communicate_async(rec, local=local).get(timeout=timeout)
  File "/opt/conda/lib/python3.7/site-packages/wandb/sdk/interface/interface_shared.py", line 231, in _communicate_async
    raise Exception("The wandb backend process has shutdown")
