#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 64 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381














































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 1 | Train Loss: 5.407435406302785 | Val Loss: 4.914701965120104 | Val Padded_cmAP : 0.49225015126494476
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.11it/s]
100%|██████████| 27/27 [00:19<00:00,  1.39it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 3 | Train Loss: 3.5943437663274014 | Val Loss: 2.023586599915116 | Val Padded_cmAP : 0.7725561846993588
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 5 | Train Loss: 2.944862052749733 | Val Loss: 1.6644260618421767 | Val Padded_cmAP : 0.8213863820747355
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/307 [00:00<?, ?it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 7 | Train Loss: 2.635384192295882 | Val Loss: 1.476194436903353 | Val Padded_cmAP : 0.8427204790846304
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








 93%|█████████▎| 25/27 [00:19<00:00,  2.00it/s]
100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
Epoch: 11 | Train Loss: 2.285103759858818 | Val Loss: 1.300464113553365 | Val Padded_cmAP : 0.8660759659419831
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.30it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 13 | Train Loss: 2.195823550224304 | Val Loss: 1.1969871024290721 | Val Padded_cmAP : 0.8728097740418025
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 14 | Train Loss: 2.1549285432803127 | Val Loss: 1.1728061746667933 | Val Padded_cmAP : 0.874636533858613
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]









100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
Epoch: 15 | Train Loss: 2.1121872566421955 | Val Loss: 1.177274798905408 | Val Padded_cmAP : 0.8747731688905689
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








 96%|█████████▋| 26/27 [00:19<00:00,  2.09it/s]
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 19 | Train Loss: 1.9646186413128135 | Val Loss: 1.0933406628944256 | Val Padded_cmAP : 0.8869659955610838
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.30it/s]
Epoch: 20 | Train Loss: 1.9383057371412893 | Val Loss: 1.0876164237658184 | Val Padded_cmAP : 0.8879230212257305
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
Epoch: 21 | Train Loss: 1.8988232709685833 | Val Loss: 1.0531541197388261 | Val Padded_cmAP : 0.8877883322288044
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.96it/s]
100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








 93%|█████████▎| 25/27 [00:19<00:01,  1.86it/s]
100%|██████████| 27/27 [00:19<00:00,  1.36it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
Epoch: 24 | Train Loss: 1.822837686694018 | Val Loss: 1.0158294262709442 | Val Padded_cmAP : 0.893484120390049
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
Epoch: 25 | Train Loss: 1.7916689625780435 | Val Loss: 1.0227913459142048 | Val Padded_cmAP : 0.8937378475790368
















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]







100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
  0%|          | 0/307 [00:00<?, ?it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]







100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/307 [00:00<?, ?it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 28 | Train Loss: 1.715661244206009 | Val Loss: 0.9850858240215866 | Val Padded_cmAP : 0.8969762055461881
















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]








 96%|█████████▋| 26/27 [00:19<00:00,  2.14it/s]
100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]







100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/307 [00:00<?, ?it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
  0%|          | 0/307 [00:00<?, ?it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.35it/s]
Epoch: 34 | Train Loss: 1.6154195427506288 | Val Loss: 0.9642598606922008 | Val Padded_cmAP : 0.8995077915716482
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.33it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:46<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
  0%|          | 0/307 [00:00<?, ?it/s]
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:20<00:00,  1.34it/s]
  0%|          | 0/307 [00:00<?, ?it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]







 89%|████████▉ | 24/27 [00:18<00:01,  1.88it/s]
100%|██████████| 27/27 [00:19<00:00,  1.37it/s]















































































































100%|██████████| 307/307 [03:46<00:00,  1.36it/s]








100%|██████████| 27/27 [00:19<00:00,  1.35it/s]
Epoch: 39 | Train Loss: 1.5397355183716317 | Val Loss: 0.9293545539732333 | Val Padded_cmAP : 0.9032847301530214
















































































































100%|██████████| 307/307 [03:47<00:00,  1.35it/s]








100%|██████████| 27/27 [00:19<00:00,  1.37it/s]
Epoch: 40 | Train Loss: 1.5398237227616947 | Val Loss: 0.9323128528065152 | Val Padded_cmAP : 0.9034235519170827
# Loading best model
# Infering OOF






 89%|████████▉ | 24/27 [00:13<00:01,  2.33it/s]
>>> FOLD 1 Padded_cmAP = 0.903
100%|██████████| 27/27 [00:14<00:00,  1.90it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value

















wandb : 100%|██████████| 681/681 [00:34<00:00, 19.76it/s]