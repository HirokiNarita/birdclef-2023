#########################
#### Training
#### Fold: 1 | Image Size: (224, 313) | Model: tf_efficientnet_b1_ns | Batch Size: 128 | Scheduler: cos
#### Num Train: 19,627 | Num Valid: 3,381



































































100%|██████████| 154/154 [02:23<00:00,  1.07it/s]








100%|██████████| 27/27 [00:19<00:00,  1.36it/s]
Epoch: 1 | Train Loss: 5.48538038637731 | Val Loss: 5.172176767278601 | Val Padded_cmAP : 0.48488543461412137



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 96%|█████████▋| 26/27 [00:18<00:00,  2.59it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.70it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.07it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








 89%|████████▉ | 24/27 [00:18<00:01,  2.23it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]



































































100%|██████████| 154/154 [02:17<00:00,  1.12it/s]









100%|██████████| 27/27 [00:20<00:00,  1.31it/s]
Epoch: 6 | Train Loss: 2.5578227492121908 | Val Loss: 1.559083605254138 | Val Padded_cmAP : 0.8282638766205163



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 7 | Train Loss: 2.395554914102926 | Val Loss: 1.466030964144954 | Val Padded_cmAP : 0.8393634806085257




































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
Epoch: 8 | Train Loss: 2.258532244663734 | Val Loss: 1.3382425606250763 | Val Padded_cmAP : 0.855066956378756



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]







100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.38it/s]
Epoch: 10 | Train Loss: 2.061558597273641 | Val Loss: 1.2501659856902227 | Val Padded_cmAP : 0.8653426333495323



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 11 | Train Loss: 2.0090733302104007 | Val Loss: 1.2621012926101685 | Val Padded_cmAP : 0.8656950182157341



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:18<00:01,  1.97it/s]
100%|██████████| 27/27 [00:19<00:00,  1.41it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]




































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
Epoch: 15 | Train Loss: 1.820994658903642 | Val Loss: 1.146110701340216 | Val Padded_cmAP : 0.8796736172720517



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]







100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]







100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]







100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]







100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
Epoch: 20 | Train Loss: 1.6486890099265359 | Val Loss: 1.0712824706678037 | Val Padded_cmAP : 0.8879144500524625



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.39it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:18<00:00,  1.43it/s]
Epoch: 24 | Train Loss: 1.545799870769699 | Val Loss: 1.023314172471011 | Val Padded_cmAP : 0.8924706233202434



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.40it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.12it/s]








100%|██████████| 27/27 [00:19<00:00,  1.41it/s]
  0%|          | 0/154 [00:00<?, ?it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








 93%|█████████▎| 25/27 [00:18<00:00,  2.00it/s]
100%|██████████| 27/27 [00:19<00:00,  1.40it/s]



































































100%|██████████| 154/154 [02:18<00:00,  1.11it/s]








100%|██████████| 27/27 [00:19<00:00,  1.42it/s]
Epoch: 30 | Train Loss: 1.4419172189452432 | Val Loss: 0.969214384202604 | Val Padded_cmAP : 0.8966110176302929
# Loading best model
# Infering OOF




 93%|█████████▎| 25/27 [00:09<00:00,  3.68it/s]
>>> FOLD 1 Padded_cmAP = 0.897
100%|██████████| 27/27 [00:09<00:00,  2.73it/s]
/opt/conda/lib/python3.7/site-packages/pandas/core/frame.py:3678: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`
  self[col] = igetitem(value, i)
/opt/conda/lib/python3.7/site-packages/pandas/core/indexing.py:1667: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value


















wandb : 100%|██████████| 708/708 [00:34<00:00, 20.31it/s]